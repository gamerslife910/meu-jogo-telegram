<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EURODASH V14</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; text-align: center; overflow-x: hidden; }
        .lang-bar { display: flex; justify-content: center; gap: 8px; padding: 15px; background: #111; border-bottom: 2px solid #0f9; }
        .t-btn { background: #222; color: #0f9; border: 1px solid #0f9; padding: 6px 12px; border-radius: 8px; font-weight: bold; font-size: 12px; cursor: pointer; }
        .t-btn.active { background: #0f9; color: #000; }
        #balance { font-size: 40px; margin: 20px 0; font-weight: bold; color: #0f9; text-shadow: 0 0 10px rgba(0,255,153,0.3); }
        .main-img { width: 170px; height: 170px; border-radius: 50%; border: 4px solid #0f9; box-shadow: 0 0 15px #0f9; cursor: pointer; transition: transform 0.1s; }
        .main-img:active { transform: scale(0.92); }
        .tab { display: none; padding: 20px; padding-bottom: 120px; height: 75vh; overflow-y: auto; }
        .item { background: #0a0a0a; border: 1px solid #1a1a1a; padding: 12px; border-radius: 12px; display: flex; align-items: center; margin-bottom: 12px; gap: 15px; }
        .m-img { width: 65px; height: 65px; border-radius: 12px; border: 1px solid #0f9; object-fit: cover; background: #111; }
        .m-info { flex-grow: 1; text-align: left; }
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; background: #000; border-top: 1px solid #222; padding-bottom: 25px; z-index: 100; }
        .n-btn { flex: 1; padding: 20px; color: #555; font-weight: bold; cursor: pointer; }
        .n-btn.active { color: #0f9; }
        h2 { margin-top: 0; color: #0f9; }
    </style>
</head>
<body>

    <div class="lang-bar">
        <button class="t-btn active" id="btn-pt" onclick="setL('pt')">PT</button>
        <button class="t-btn" id="btn-en" onclick="setL('en')">EN</button>
        <button class="t-btn" id="btn-ru" onclick="setL('ru')">RU</button>
    </div>

    <div id="core-p" class="tab" style="display:block;">
        <div id="balance">0.00000</div>
        <img src="image_3.jpg" class="main-img" onclick="ck()" onerror="this.src='https://via.placeholder.com/170/000/0f9?text=EURODASH'">
        <p style="color:#0f9; margin-top:20px; font-weight: bold;">ENERGY: <span id="eg">500</span></p>
    </div>

    <div id="shop-p" class="tab">
        <h2 id="m-tit">MERCADO</h2>
        <div id="list"></div>
    </div>

    <div class="nav">
        <div class="n-btn active" id="nb-c" onclick="sw('c')">CORE</div>
        <div class="n-btn" id="nb-s" onclick="sw('s')">MARKET</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        let L = 'pt';
        const txt = {
            pt: { m: "MERCADO", b: "COMPRAR", names: ["Nó Micro","Rack Blade","Turbo Server","Cyber Station","Quantum Rig","Hub Neural","Núcleo Titan"] },
            en: { m: "MARKET", b: "UPGRADE", names: ["Micro Node","Blade Rack","Turbo Server","Cyber Station","Quantum Rig","Neural Hub","Titan Core"] },
            ru: { m: "РЫНОК", b: "КУПИТЬ", names: ["Микро Узел","Blade Стойка","Турбо Сервер","Кибер Станция","Квантовый Риг","Нейро Хаб","Ядро Титана"] }
        };

        firebase.initializeApp({
            apiKey: "AIzaSyDFpFu8sba50rqnJSstg--cLrNDG4ybmu8",
            authDomain: "eurodash-e466c.firebaseapp.com",
            databaseURL: "https://eurodash-e466c-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "eurodash-e466c",
            appId: "1:99813963051:web:fe96761e990aee01ec016e"
        });
        
        const db = firebase.database();
        const id = tg.initDataUnsafe.user?.id || 22250;
        
        let u = { bal: 0, pps: 0, eng: 500, inv: [0,0,0,0,0,0,0] };
        
        const sk = [
            {p:0.05, g:0.00001, img: "miner1.jpg"}, 
            {p:1, g:0.00006, img: "miner2.jpg"}, 
            {p:10, g:0.00075, img: "miner3.jpg"}, 
            {p:50, g:0.0045, img: "miner4.jpg"}, 
            {p:200, g:0.021, img: "miner5.jpg"}, 
            {p:800, g:0.095, img: "miner6.jpg"}, 
            {p:3000, g:0.45, img: "miner7.jpg"}
        ];

        function setL(l) {
            L = l;
            document.querySelectorAll('.t-btn').forEach(b => b.classList.toggle('active', b.id === 'btn-' + l));
            document.getElementById('m-tit').innerText = txt[l].m;
            if(document.getElementById('shop-p').style.display === 'block') rd();
        }

        db.ref('users/'+id).once('value', s => { 
            if(s.exists()) {
                let d = s.val();
                u.bal = Number(d.bal) || 0;
                u.pps = Number(d.pps) || 0;
                u.eng = Number(d.eng) || 500;
                u.inv = Array.isArray(d.inv) ? d.inv : [0,0,0,0,0,0,0];
            }
            up(); 
        });

        function ck() {
            if(u.eng < 1) return;
            u.bal += 0.00005; u.eng -= 1;
            up(); tg.HapticFeedback.impactOccurred('light');
        }

        function rd() {
            document.getElementById('list').innerHTML = sk.map((m,i) => `
                <div class="item">
                    <img src="${m.img}" class="m-img" onerror="this.src='https://via.placeholder.com/65/111/0f9?text=M${i+1}'">
                    <div class="m-info">
                        <b style="color:#0f9">${txt[L].names[i]}</b><br>
                        <small>Lvl: ${u.inv[i]||0} | +${(m.g*3600).toFixed(4)}/h</small>
                    </div>
                    <button onclick="buy(${i})" style="background:#0f9; border:none; padding:10px; border-radius:8px; font-weight:bold; color:#000;">
                        €${m.p}
                    </button>
                </div>
            `).join('');
        }

        function buy(i) {
            if(u.bal >= sk[i].p) {
                u.bal -= sk[i].p; u.pps += sk[i].g;
                u.inv[i] = (u.inv[i]||0) + 1; 
                rd(); up();
                tg.HapticFeedback.notificationOccurred('success');
            } else {
                tg.HapticFeedback.notificationOccurred('error');
            }
        }

        function up() {
            document.getElementById('balance').innerText = u.bal.toFixed(5);
            document.getElementById('eg').innerText = Math.floor(u.eng);
        }

        function sw(t) {
            document.getElementById('core-p').style.display = t === 'c' ? 'block' : 'none';
            document.getElementById('shop-p').style.display = t === 's' ? 'block' : 'none';
            document.getElementById('nb-c').classList.toggle('active', t === 'c');
            document.getElementById('nb-s').classList.toggle('active', t === 's');
            if(t === 's') rd();
        }

        setInterval(() => { 
            u.bal += u.pps; 
            if(u.eng < 500) u.eng += 0.5; 
            up(); 
        }, 1000);
        setInterval(() => db.ref('users/'+id).set(u), 5000);
    </script>
</body>
</html>
