<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EURODASH OFFICIAL</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        body { background-color: #050505; color: #fff; font-family: 'Rajdhani', sans-serif; margin: 0; text-align: center; overflow: hidden; user-select: none; -webkit-tap-highlight-color: transparent; }
        #matrix-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; }

        .ticker-wrap { position: fixed; top: 40px; left: 0; width: 100%; background: rgba(0,0,0,0.8); overflow: hidden; height: 25px; line-height: 25px; z-index: 40; border-bottom: 1px solid #333; }
        .ticker { display: inline-block; white-space: nowrap; padding-left: 100%; animation: ticker 30s linear infinite; color: #0f9; font-size: 12px; font-weight: bold; }
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        .tab { display: none; padding: 20px; padding-top: 75px; padding-bottom: 90px; height: 85vh; overflow-y: auto; scrollbar-width: none; }
        .buy-btn { background: #0f9; color: #000; border: none; padding: 8px 20px; border-radius: 4px; font-weight: bold; font-family: 'Rajdhani'; cursor: pointer; text-transform: uppercase; font-size: 14px; box-shadow: 0 0 10px rgba(0,255,153,0.2); transition: 0.1s; }
        .buy-btn:active { transform: scale(0.95); }
        .w-btn { background: #ff3333; color: #fff; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px rgba(255,0,0,0.3); }
        .dep-btn { background: #00ccff; color: #000; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px rgba(0,204,255,0.3); }
        .set-btn { background: #333; color: #fff; border: 1px solid #555; padding: 10px; width: 100%; margin-bottom: 8px; border-radius: 5px; text-align: left; cursor: pointer; font-family: 'Rajdhani'; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }

        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index: 200; align-items:center; justify-content:center; flex-direction:column; backdrop-filter: blur(5px); }
        .modal-box { background: #111; border: 1px solid #0f9; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 0 30px rgba(0,255,153,0.1); width: 85%; max-width: 350px; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; color: #555; font-size: 24px; cursor: pointer; }
        .inp { width: 90%; background: #000; border: 1px solid #333; color: #fff; padding: 10px; margin: 10px 0; border-radius: 5px; font-family: monospace; text-align: center; }
        .inp:focus { border-color: #0f9; outline: none; }

        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: 'VT323', monospace; }
        .boot-text { color: #0f9; font-size: 16px; width: 80%; text-align: left; margin-bottom: 5px; text-shadow: 0 0 5px #0f9; }
        .glitch { font-size: 50px; font-weight: bold; color: #fff; text-shadow: 2px 2px #0f9; animation: glitch 1s infinite; letter-spacing: 5px; margin-bottom: 20px; font-family: 'Rajdhani'; }
        @keyframes glitch { 0% { transform: translate(0); } 20% { transform: translate(-2px, 2px); } 40% { transform: translate(-2px, -2px); } 60% { transform: translate(2px, 2px); } 80% { transform: translate(2px, -2px); } 100% { transform: translate(0); } }

        .main-img-con { position: relative; width: 220px; height: 220px; margin: 0 auto; display: flex; align-items: center; justify-content: center; }
        .main-img { width: 100%; height: 100%; border-radius: 50%; border: 2px solid rgba(0,255,153,0.3); box-shadow: 0 0 30px rgba(0,255,153,0.2); cursor: pointer; z-index: 10; -webkit-user-drag: none; }
        .main-img.click-anim { animation: pulseWave 0.15s ease-out; }
        @keyframes pulseWave { 0% { transform: scale(0.96); border-color:#fff; } 100% { transform: scale(1); border-color:rgba(0,255,153,0.3); } }

        .float-text { position: absolute; color: #fff; font-weight: bold; font-size: 24px; pointer-events: none; animation: floatUp 0.8s ease-out forwards; text-shadow: 0 0 5px #0f9; z-index: 20; }
        .crit { color: #ffd700 !important; font-size: 32px !important; text-shadow: 0 0 15px #ffaa00 !important; z-index: 25; }
        .lucky { color: #00ccff !important; font-size: 28px !important; text-shadow: 0 0 15px #00ccff !important; z-index: 30; }
        @keyframes floatUp { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), -100px) scale(1.2); opacity: 0; } }

        .eng-bar-bg { width: 200px; height: 10px; background: #222; margin: 5px auto; border-radius: 5px; overflow: hidden; border: 1px solid #333; position: relative; }
        .eng-bar-fill { height: 100%; background: #0f9; width: 100%; box-shadow: 0 0 10px #0f9; transition: width 0.2s; }
        .boost-btn { position: absolute; right: -35px; top: -8px; background: #ffd700; color: #000; border-radius: 50%; width: 26px; height: 26px; font-size: 14px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; border: 2px solid #fff; box-shadow: 0 0 10px #ffd700; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        .lvl-con { width: 60%; margin: 0 auto 5px auto; background: #111; height: 6px; border-radius: 3px; position: relative; border: 1px solid #333; display: inline-block; vertical-align: middle; }
        .lvl-fill { height: 100%; background: linear-gradient(90deg, #0f9, #00ffff); width: 0%; border-radius: 3px; transition: width 0.5s; box-shadow: 0 0 10px #0f9; }
        .info-btn { background: #333; color: #fff; border: 1px solid #555; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; cursor: pointer; margin-left: 5px; display: inline-flex; align-items: center; justify-content: center; }

        .card { background: rgba(10,10,10,0.8); border: 1px solid #222; border-left: 3px solid #0f9; border-radius: 10px; padding: 15px; margin-bottom: 12px; text-align: left; display: flex; align-items: center; justify-content: space-between; backdrop-filter: blur(5px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .market-header { background: #111; padding: 15px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        
        .rank-row { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #222; }
        .rank-img { width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; border: 1px solid #0f9; background: #333; }
        
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; background: rgba(5,5,5,0.95); border-top: 1px solid #222; padding-bottom: 20px; padding-top: 10px; z-index: 100; backdrop-filter: blur(10px); }
        .n-btn { flex: 1; color: #444; font-size: 10px; font-weight: bold; display: flex; flex-direction: column; align-items: center; gap: 5px; text-transform: uppercase; letter-spacing: 1px; position: relative; }
        .n-btn.active { color: #0f9; text-shadow: 0 0 10px rgba(0,255,153,0.6); }
        .n-icon { font-size: 22px; margin-bottom: 2px; }
        
        .badge { position: absolute; top: 0; right: 25%; width: 8px; height: 8px; background: red; border-radius: 50%; border: 1px solid #fff; display: none; box-shadow: 0 0 5px red; }

        #force-btn { display:none; margin-top:20px; padding:10px 20px; background:red; color:#fff; border:none; border-radius:5px; font-weight:bold; cursor:pointer; font-size:12px; z-index:99999; }
        
        .lang-bar { position: absolute; top: 10px; right: 10px; z-index: 50; display: flex; gap: 5px; }
        .l-btn { background: rgba(0,0,0,0.6); color: #888; border: 1px solid #333; padding: 3px 8px; border-radius: 5px; font-size: 10px; cursor: pointer; font-weight: bold; }
        .l-btn.active { color: #0f9; border-color: #0f9; box-shadow: 0 0 5px rgba(0,255,153,0.3); }

        .settings-icon { position: absolute; top: 10px; left: 10px; z-index: 50; background: rgba(0,0,0,0.6); border: 1px solid #333; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 18px; }
        
        .online-cnt { position: absolute; top: 45px; left: 10px; z-index: 50; font-size: 10px; color: #0f9; background: rgba(0,0,0,0.7); padding: 2px 6px; border-radius: 4px; border: 1px solid #333; }

        .day-grid { display: flex; gap: 5px; justify-content: center; margin-top: 10px; }
        .day-box { background: #222; border: 1px solid #333; padding: 5px; width: 30px; font-size: 10px; opacity: 0.5; border-radius: 4px; }
        .day-box.active { border-color: #0f9; opacity: 1; box-shadow: 0 0 5px #0f9; background: rgba(0,255,153,0.1); }

        .admin-row { background: #222; padding: 10px; margin-bottom: 5px; border-left: 3px solid orange; text-align: left; font-size: 12px; }
        .admin-actions { display: flex; gap: 5px; margin-top: 5px; }
        .a-btn { padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer; font-weight: bold; flex: 1; }
        .a-check { background: #00ccff; color: #000; }
        .a-approve { background: #0f9; color: #000; }
        .a-reject { background: #f00; color: #fff; }
        
        .game-box { background:#111; border:1px solid #333; border-radius:10px; padding:20px; margin-bottom:10px; text-align:center; position:relative; overflow:hidden;}
        .game-res { font-size:32px; font-weight:bold; margin:10px 0; color:#fff; min-height:40px; }
        .win { color:#0f9; text-shadow:0 0 20px #0f9; }
        .lose { color:#f00; text-shadow:0 0 20px #f00; }
        .coin-anim { animation: spin 1s infinite linear; }
        @keyframes spin { 0% { transform: rotateY(0); } 100% { transform: rotateY(360deg); } }
        
        .fallback-icon { font-size:30px; display:flex; align-items:center; justify-content:center; width:50px; height:50px; background:#222; border-radius:5px; border:1px solid #333; color: #fff; }
        
        #debug-box { display:none; }
    </style>
</head>
<body>
    <canvas id="matrix-bg"></canvas>

    <div class="ticker-wrap">
        <div class="ticker" id="news-ticker">...</div>
    </div>

    <div class="settings-icon" onclick="openModal('modal-settings')">‚öôÔ∏è</div>
    
    <div class="online-cnt" id="online-users">üü¢ 342 Online</div>

    <div class="lang-bar">
        <div class="l-btn active" id="btn-en" onclick="setLang('en')">EN</div>
        <div class="l-btn" id="btn-pt" onclick="setLang('pt')">PT</div>
        <div class="l-btn" id="btn-ru" onclick="setLang('ru')">RU</div>
        <div class="l-btn" id="btn-admin" style="display:none; border-color: orange; color: orange;" onclick="sw('admin')">ADMIN</div>
    </div>

    <div id="loader">
        <div class="glitch">EURODASH</div>
        <div id="boot-seq" style="width: 100%; display: flex; flex-direction: column; align-items: center;"></div>
        <div id="debug-box"></div>
        <button id="force-btn" onclick="finishLoad()">‚ö†Ô∏è FORCE START</button>
    </div>

    <div id="modal-settings" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-settings')">&times;</span>
            <h2 style="color:#fff; margin-bottom:20px;">SETTINGS</h2>
            <button class="set-btn" onclick="toggleSound()"><span>Sound Effects</span> <span id="snd-stat">ON üîä</span></button>
            <button class="set-btn" onclick="closeModal('modal-settings'); openModal('modal-tutorial');"><span>Replay Tutorial</span> <span>üéì</span></button>
            <button class="set-btn" onclick="openSupport()"><span>Support</span> <span>üìû</span></button>
            <button class="set-btn" onclick="openChannel()"><span>Official Channel</span> <span>üì¢</span></button>
            <p style="color:#555; font-size:10px; margin-top:20px;">UID: <span id="disp-uid">...</span></p>
        </div>
    </div>

    <div id="modal-tutorial" class="modal">
        <div class="modal-box">
            <h2 style="color:#0f9">WELCOME, MINER!</h2>
            <div style="text-align:left; font-size:14px; margin:20px 0; color:#ddd;">
                1. üëÜ <b>TAP</b> to generate Energy.<br><br>
                2. üõçÔ∏è <b>BUY</b> Miners in the Shop to earn money while you sleep.<br><br>
                3. üé≤ <b>PLAY</b> Games to double your cash.<br><br>
                4. üí∞ <b>WITHDRAW</b> real money via TRC20.<br><br>
                <div style="background:#222; border:1px solid #0f9; padding:10px; border-radius:5px; text-align:center;">
                    <b style="color:#0f9">GIFT:</b> You received 1x Free CPU Miner!
                </div>
            </div>
            <button class="buy-btn" style="width:100%" onclick="closeModal('modal-tutorial')">LET'S GO!</button>
        </div>
    </div>

    <div id="modal-daily" class="modal">
        <div class="modal-box">
            <h2 style="color:#ffd700;">DAILY STREAK üî•</h2>
            <p style="color:#aaa; font-size:12px;">Come back every day to earn more!</p>
            <div class="day-grid">
                <div class="day-box" id="day-1">1<br>‚Ç¨0.01</div>
                <div class="day-box" id="day-2">2<br>‚Ç¨0.03</div>
                <div class="day-box" id="day-3">3<br>‚Ç¨0.05</div>
                <div class="day-box" id="day-4">4<br>‚Ç¨0.08</div>
                <div class="day-box" id="day-5">5<br>‚Ç¨0.12</div>
                <div class="day-box" id="day-6">6<br>‚Ç¨0.20</div>
                <div class="day-box" id="day-7" style="color:#ffd700">7<br>‚Ç¨0.50</div>
            </div>
            <h1 style="color:#0f9; margin:15px 0;">+‚Ç¨<span id="daily-amt">0.00</span></h1>
            <button class="buy-btn" onclick="claimDaily()" id="btn-claim-daily">CLAIM REWARD</button>
        </div>
    </div>

    <div id="modal-refill" class="modal">
        <div class="modal-box">
            <h2 style="color:#0f9">‚ö° ENERGY BOOST</h2>
            <p style="color:#aaa;">Refill 500 Energy instantly?</p>
            <h1 style="color:#fff;">Price: <span style="color:#ffd700">‚Ç¨0.05</span></h1>
            <button class="buy-btn" onclick="buyRefill()">BUY REFILL</button>
            <br><br>
            <button class="buy-btn" style="background:#333; color:#fff" onclick="closeModal('modal-refill')">CANCEL</button>
        </div>
    </div>

    <div id="modal-offline" class="modal">
        <div class="modal-box">
            <h2 style="color:#fff;" id="t-welcome">WELCOME BACK</h2>
            <p style="color:#aaa;" id="t-off-earn">Offline Earnings:</p>
            <h1 style="color:#0f9; font-size:40px;">+‚Ç¨<span id="off-val">0.00</span></h1>
            <button class="buy-btn" onclick="closeModal('modal-offline')" id="t-collect">COLLECT</button>
        </div>
    </div>

    <div id="modal-levels" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-levels')">&times;</span>
            <h3 style="color:#0f9" id="t-lvl-sys">LEVEL SYSTEM</h3>
            <div style="text-align:left; font-size:14px; color:#ddd; line-height:1.6;">
                <b style="color:#fff">1. NOOB (‚Ç¨0-10)</b><br>Basic mining speed.<br><br>
                <b style="color:#00ffff">2. HACKER (‚Ç¨10-50)</b><br>+2% Critical Chance.<br><br>
                <b style="color:#ff00ff">3. CYBER LORD (‚Ç¨50-200)</b><br>+5% Critical Chance.<br><br>
                <b style="color:#ffd700">4. TITAN (‚Ç¨200+)</b><br>+10% Critical Chance + Max Energy.
            </div>
        </div>
    </div>

    <div id="modal-withdraw" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-withdraw')">&times;</span>
            <h3 style="color:#ff3333" id="t-wd-tit">WITHDRAW (TRC20)</h3>
            <p style="font-size:12px; color:#888;" id="t-wd-info">Min: ‚Ç¨1.00 | Fee: 2%</p>
            
            <div style="text-align:right; margin-bottom:5px; font-size:12px;">
                <span style="color:#888" id="t-avail">Available:</span> <span style="color:#fff">‚Ç¨<span id="wd-avail">0.00</span></span>
                <span style="color:#0f9; cursor:pointer; margin-left:8px; font-weight:bold; border:1px solid #0f9; padding:0 4px; border-radius:3px;" onclick="setMax()">MAX</span>
            </div>

            <input type="text" id="wd-addr" class="inp" placeholder="Paste TRC20 Address">
            <input type="number" id="wd-amount" class="inp" placeholder="Amount (‚Ç¨)" oninput="calcFee()">
            
            <div style="font-size:13px; margin:10px 0; background:#222; padding:10px; border-radius:5px;">
                <span id="t-receive">You Receive:</span> <b style="color:#fff; font-size:16px;">‚Ç¨<span id="wd-final">0.00</span></b>
                <div style="color:#555; font-size:10px;" id="t-fee-inc">(Fees included)</div>
            </div>
            <div style="margin-bottom:10px; font-size:11px; text-align:left; color:#aaa; max-height:60px; overflow-y:auto;" id="wd-history"></div>
            <button class="w-btn" onclick="submitWithdraw()" id="t-confirm">CONFIRM</button>
        </div>
    </div>

    <div id="modal-deposit" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-deposit')">&times;</span>
            <h3 style="color:#00ccff" id="t-dep-tit">DEPOSIT (USDT)</h3>
            <p style="font-size:12px; color:#aaa;" id="t-dep-info">Send USDT (TRC20) to this address:</p>
            <div style="background:#fff; padding:10px; display:inline-block; border-radius:10px; margin:10px 0;">
                <img id="qr-code" src="" width="120" height="120" onerror="this.style.display='none'">
            </div>
            <div style="background:#222; padding:10px; font-size:10px; word-break:break-all; color:#0f9; border:1px dashed #555; user-select:text;" id="admin-wallet">...</div>
            <button class="buy-btn" style="margin-top:5px; font-size:10px;" onclick="copyWallet()" id="t-copy">COPY ADDRESS</button>
            <hr style="border-color:#333; margin:15px 0;">
            <p style="font-size:12px; color:#aaa;" id="t-hash-info">Paste Transaction Hash (TXID):</p>
            <input type="text" id="dep-hash" class="inp" placeholder="Transaction Hash">
            <button class="dep-btn" onclick="submitDeposit()" id="t-sent">I SENT IT</button>
        </div>
    </div>

    <div id="tab-core" class="tab" style="display:block;">
        <div id="balance" style="font-size:52px; font-weight:700; margin-top:20px;">‚Ç¨<span id="bal-val">0.00000</span></div>
        <div style="margin-bottom:20px;">
            <div class="lvl-con"><div class="lvl-fill" id="l-fill"></div></div>
            <button class="info-btn" onclick="openModal('modal-levels')">?</button>
            <div style="font-size:12px; color:#aaa; letter-spacing:2px;" id="l-name">NOOB</div>
        </div>
        <div class="main-img-con">
            <img src="image_3.jpg" class="main-img" id="click-btn" onerror="this.src='https://via.placeholder.com/220/000/0f9?text=TAP'">
        </div>
        <div style="margin-top:20px; display:flex; justify-content:center; gap:30px;">
            <div>
                <b style="color:#0f9; font-size:20px;">‚ö° <span id="eg">500</span></b>
                <div class="eng-bar-bg">
                    <div class="eng-bar-fill" id="eng-bar"></div>
                    <div class="boost-btn" onclick="openModal('modal-refill')">+</div>
                </div>
                <small style="color:#555" id="t-energy">ENERGY</small>
            </div>
            <div style="margin-top:5px;">
                <b style="color:#0f9; font-size:20px;">üöÄ <span id="pps-disp">0</span></b><br>
                <small style="color:#555" id="t-pps">PROFIT/SEC</small>
            </div>
        </div>
    </div>

    <div id="tab-shop" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-market">MARKET</h2>
        <div class="market-header">
            <div style="text-align:left;">
                <span style="font-size:12px; color:#888;" id="t-wallet">WALLET</span><br>
                <b style="font-size:18px;">‚Ç¨<span id="bal-shop">0.00</span></b>
            </div>
            <div style="display:flex; gap:5px;">
                <button class="dep-btn" onclick="openModal('modal-deposit')" id="t-btn-dep">DEP</button>
                <button class="w-btn" onclick="openModal('modal-withdraw')" id="t-btn-wd">W/D</button>
            </div>
        </div>
        <div id="shop-list"></div>
    </div>

    <div id="tab-games" class="tab">
        <div class="game-box">
            <h3 style="color:#0f9; margin:0;">CYBER DICE üé≤</h3>
            <p style="color:#aaa; font-size:12px;">Roll > 55 to Win 2x</p>
            <div class="game-res" id="dice-result">?</div>
            <input type="number" id="dice-bet" class="inp" placeholder="Bet (‚Ç¨)" style="width:50%;">
            <br>
            <button class="buy-btn" style="margin-top:10px; width:60%;" onclick="rollDice()">ROLL</button>
        </div>
        <div class="game-box" style="border-left:3px solid #ffd700;">
            <h3 style="color:#ffd700; margin:0;">COIN FLIP ü™ô</h3>
            <p style="color:#aaa; font-size:12px;">Heads or Tails (2x)</p>
            <div class="game-res" id="coin-result">üü°</div>
            <input type="number" id="coin-bet" class="inp" placeholder="Bet (‚Ç¨)" style="width:50%;">
            <div style="margin-top:10px;">
                <button class="buy-btn" style="background:#444; color:#fff;" onclick="flipCoin('heads')">HEADS</button>
                <button class="buy-btn" style="background:#ffd700; color:#000;" onclick="flipCoin('tails')">TAILS</button>
            </div>
        </div>
    </div>

    <div id="tab-friends" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-net-tit">NETWORK</h2>
        <div class="card" style="display:block; text-align:center;">
            <h1>üíé</h1>
            <p style="color:#aaa;" id="t-inv-desc">Invite friends & earn 5% of their mining!</p>
            <div style="background:#000; padding:10px; color:#0f9; font-size:12px; border:1px dashed #333; margin-bottom:10px; word-break:break-all;" id="my-link">...</div>
            <button onclick="copyLink()" class="buy-btn" style="width:100%" id="t-copy-link">COPY LINK</button>
        </div>
    </div>

    <div id="tab-earn" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-task-tit">TASKS</h2>
        <div class="card">
            <div><b style="color:#fff" id="t-join-ch">Join Official Channel</b><br><small style="color:#0f9" id="t-rew">+‚Ç¨0.10 Reward</small></div>
            <button class="buy-btn" id="task-group" onclick="doTask('group', 0.10)">START</button>
        </div>
        <div class="card" style="display:block;">
            <b style="color:#fff" id="t-promo-tit">SECRET CODE</b><br>
            <input type="text" id="promo-in" class="inp" placeholder="Enter Code" style="margin-bottom:5px;">
            <button class="buy-btn" style="width:100%" onclick="redeemCode()" id="t-redeem">REDEEM</button>
        </div>
    </div>

    <div id="tab-rank" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-rank-tit">TOP INVESTORS</h2>
        <div style="background:#111; border-radius:10px; padding:10px; border:1px solid #333;" id="rank-list">
            <div style="padding:20px; color:#555;" id="t-load-rank">Loading real data...</div>
        </div>
    </div>

    <div id="tab-admin" class="tab">
        <h2 style="color:orange; border-bottom:1px solid orange;">ADMIN PANEL üëÆ‚Äç‚ôÇÔ∏è</h2>
        <p style="font-size:12px; color:#888;">Pending Deposits</p>
        <div id="admin-list" style="margin-top:10px; max-height:80vh; overflow-y:auto;"></div>
    </div>

    <div class="nav">
        <div class="n-btn active" id="nb-core" onclick="sw('core')">
            <span class="n-icon">‚ö°</span><span id="n-mine">MINE</span>
        </div>
        <div class="n-btn" id="nb-shop" onclick="sw('shop')">
            <span class="n-icon">üõçÔ∏è</span><span id="n-shop">SHOP</span>
            <div class="badge" id="badge-shop"></div>
        </div>
        <div class="n-btn" id="nb-games" onclick="sw('games')">
            <span class="n-icon">üé≤</span><span id="n-games">GAMES</span>
            <div class="badge" id="badge-games"></div>
        </div>
        <div class="n-btn" id="nb-friends" onclick="sw('friends')">
            <span class="n-icon">üë•</span><span id="n-team">TEAM</span>
        </div>
        <div class="n-btn" id="nb-rank" onclick="sw('rank')">
            <span class="n-icon">üèÜ</span><span id="n-rank">RANK</span>
        </div>
    </div>

    <script>
        // GLOBAL ERROR HANDLER
        window.onerror = function(msg, url, line) {
            let logBox = document.getElementById('debug-box');
            if(logBox) {
                logBox.style.display = 'block';
                logBox.innerHTML += `<div style="color:red; border-bottom:1px solid #333;">ERROR: ${msg} (Line ${line})</div>`;
            }
            document.getElementById('force-btn').style.display = 'block';
            return false;
        };

        function log(msg) {
            let logBox = document.getElementById('debug-box');
            if(logBox) logBox.innerHTML += `<div>>> ${msg}</div>`;
        }

        const canvas = document.getElementById('matrix-bg');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        const fontSize = 14;
        const columns = canvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);
        function drawMatrix() {
            ctx.fillStyle = 'rgba(5, 5, 5, 0.1)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0f9'; ctx.font = fontSize + 'px monospace';
            for (let i = 0; i < drops.length; i++) {
                const text = chars[Math.floor(Math.random() * chars.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
        }
        setInterval(drawMatrix, 50);
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

        let soundEnabled = true;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function toggleSound() { 
            soundEnabled = !soundEnabled; 
            document.getElementById('snd-stat').innerText = soundEnabled ? 'ON üîä' : 'OFF üîá';
        }
        function playBeep() {
            if(!soundEnabled) return;
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(300, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        const CONFIG = { telegram_link: "https://t.me/EuroDashOfficial", admin_wallet: "TWk7a3xLdEX3XWRGWaBHT1mbc8kq3JYZJw", min_withdraw: 1.00, fee: 0.02 };
        const PROMO_CODES = { "EUROSTART": 0.50, "VIKTORLAUNCH": 1.00, "HACKERBONUS": 0.25 };
        const DAILY_REWARDS = [0.01, 0.03, 0.05, 0.08, 0.12, 0.20, 0.50];
        const ADMIN_ID = 253106429; 
        const MINER_EMOJIS = ["üíª", "üñ•Ô∏è", "‚ö°", "üîã", "‚ò¢Ô∏è", "üåå"]; // 6 ITEMS

        let CUR_LANG = 'en';
        const txt = {
            en: {
                welcome: "WELCOME BACK", off_earn: "Offline Earnings:", collect: "COLLECT",
                lvl_sys: "LEVEL SYSTEM", wd_tit: "WITHDRAW (TRC20)", wd_info: "Min: ‚Ç¨1.00 | Fee: 2%",
                avail: "Available:", receive: "You Receive:", fee_inc: "(Fees included)", confirm: "CONFIRM",
                dep_tit: "DEPOSIT (USDT)", dep_info: "Send USDT (TRC20) to this address:", copy: "COPY ADDRESS",
                hash_info: "Paste Transaction Hash (TXID):", sent: "I SENT IT",
                energy: "ENERGY", pps: "PROFIT/SEC", market: "MARKET", wallet: "WALLET",
                rank_tit: "TOP INVESTORS", load_rank: "Loading real data...", rank_off: "Offline (DB Error)", net_tit: "NETWORK",
                inv_desc: "Invite friends & earn 5% of their mining!", copy_link: "COPY LINK",
                task_tit: "TASKS", join_ch: "Join Official Channel", rew: "+‚Ç¨0.10 Reward",
                promo_tit: "SECRET CODE", redeem: "REDEEM", force_play: "‚ö†Ô∏è PLAY OFFLINE", db_slow: "Connecting...", db_err: "Error: ",
                nav: ["MINE", "SHOP", "GAMES", "TEAM", "RANK"],
                miners: ["Micro Node", "Blade Rack", "Turbo Server", "Cyber Station", "Quantum Rig", "Neural Hub"],
                alerts: {
                    copied: "Copied!", invalid_trc20: "Invalid TRC20 Address!", min_wd: "Min withdraw is ‚Ç¨",
                    insufficient: "‚ùå Insufficient Balance! You only have ‚Ç¨", req_sent: "Request Sent!",
                    inv_hash: "Invalid Hash", dep_sub: "Deposit Submitted!", rew_rec: "Received!",
                    code_inv: "Invalid Code!", code_used: "Code already used!", code_ok: "Code Redeemed!", daily: "Day"
                }
            },
            pt: {
                welcome: "BEM-VINDO DE VOLTA", off_earn: "Ganhos Offline:", collect: "RECEBER",
                lvl_sys: "SISTEMA DE N√çVEIS", wd_tit: "LEVANTAR (TRC20)", wd_info: "Min: ‚Ç¨1.00 | Taxa: 2%",
                avail: "Dispon√≠vel:", receive: "Recebes:", fee_inc: "(Taxas inclu√≠das)", confirm: "CONFIRMAR",
                dep_tit: "DEPOSITAR (USDT)", dep_info: "Envia USDT (TRC20) para este endere√ßo:", copy: "COPIAR ENDERE√áO",
                hash_info: "Cola o Hash da Transa√ß√£o (TXID):", sent: "J√Å ENVIEI",
                energy: "ENERGIA", pps: "LUCRO/SEG", market: "MERCADO", wallet: "CARTEIRA",
                rank_tit: "TOP INVESTIDORES", load_rank: "A carregar dados...", rank_off: "Offline (Erro DB)", net_tit: "REDE",
                inv_desc: "Convida amigos e ganha 5% do que minerarem!", copy_link: "COPIAR LINK",
                task_tit: "TAREFAS", join_ch: "Entrar no Canal Oficial", rew: "+‚Ç¨0.10 Recompensa",
                promo_tit: "C√ìDIGO SECRETO", redeem: "RESGATAR", force_play: "‚ö†Ô∏è JOGAR OFFLINE", db_slow: "A ligar...", db_err: "Erro: ",
                nav: ["MINAR", "LOJA", "JOGOS", "EQUIPA", "RANK"],
                miners: ["Micro N√≥", "Rack Blade", "Servidor Turbo", "Esta√ß√£o Cyber", "Rig Qu√¢ntico", "Hub Neural"],
                alerts: {
                    copied: "Copiado!", invalid_trc20: "Endere√ßo TRC20 Inv√°lido!", min_wd: "M√≠nimo de levantamento √© ‚Ç¨",
                    insufficient: "‚ùå Saldo Insuficiente! Tens apenas ‚Ç¨", req_sent: "Pedido Enviado!",
                    inv_hash: "Hash Inv√°lido", dep_sub: "Dep√≥sito Enviado!", rew_rec: "Recebido!",
                    code_inv: "C√≥digo Inv√°lido!", code_used: "C√≥digo j√° usado!", code_ok: "C√≥digo Resgatado!", daily: "Dia"
                }
            },
            ru: {
                welcome: "–° –í–û–ó–í–†–ê–©–ï–ù–ò–ï–ú", off_earn: "–û—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥:", collect: "–ó–ê–ë–†–ê–¢–¨",
                lvl_sys: "–°–ò–°–¢–ï–ú–ê –£–†–û–í–ù–ï–ô", wd_tit: "–í–´–í–û–î (TRC20)", wd_info: "–ú–∏–Ω: ‚Ç¨1.00 | –ö–æ–º: 2%",
                avail: "–î–æ—Å—Ç—É–ø–Ω–æ:", receive: "–í—ã –ø–æ–ª—É—á–∏—Ç–µ:", fee_inc: "(–° –∫–æ–º–∏—Å—Å–∏–µ–π)", confirm: "–ü–û–î–¢–í–ï–†–î–ò–¢–¨",
                dep_tit: "–î–ï–ü–û–ó–ò–¢ (USDT)", dep_info: "–û—Ç–ø—Ä–∞–≤—å—Ç–µ USDT (TRC20) –Ω–∞ –∞–¥—Ä–µ—Å:", copy: "–ö–û–ü–ò–†–û–í–ê–¢–¨",
                hash_info: "–í—Å—Ç–∞–≤—å—Ç–µ —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (TXID):", sent: "–Ø –û–¢–ü–†–ê–í–ò–õ",
                energy: "–≠–ù–ï–†–ì–ò–Ø", pps: "–ü–†–ò–ë–´–õ–¨/–°–ï–ö", market: "–†–´–ù–û–ö", wallet: "–ö–û–®–ï–õ–ï–ö",
                rank_tit: "–¢–û–ü –ò–ù–í–ï–°–¢–û–†–û–í", load_rank: "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...", rank_off: "–û—Ñ–ª–∞–π–Ω (–û—à–∏–±–∫–∞ –ë–î)", net_tit: "–°–ï–¢–¨",
                inv_desc: "–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π 5%!", copy_link: "–ö–û–ü–ò–†–û–í–ê–¢–¨",
                task_tit: "–ó–ê–î–ê–ù–ò–Ø", join_ch: "–í—Å—Ç—É–ø–∏—Ç—å –≤ –∫–∞–Ω–∞–ª", rew: "+‚Ç¨0.10 –ù–∞–≥—Ä–∞–¥–∞",
                promo_tit: "–°–ï–ö–†–ï–¢–ù–´–ô –ö–û–î", redeem: "–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨", force_play: "‚ö†Ô∏è –ò–ì–†–ê–¢–¨ –û–§–õ–ê–ô–ù", db_slow: "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...", db_err: "–û—à–∏–±–∫–∞: ",
                nav: ["–ú–ê–ô–ù–ò–ù–ì", "–ú–ê–†–ö–ï–¢", "–ò–ì–†–´", "–ö–û–ú–ê–ù–î–ê", "–¢–û–ü"],
                miners: ["–ú–∏–∫—Ä–æ –£–∑–µ–ª", "Blade –°—Ç–æ–π–∫–∞", "–¢—É—Ä–±–æ –°–µ—Ä–≤–µ—Ä", "–ö–∏–±–µ—Ä –°—Ç–∞–Ω—Ü–∏—è", "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –†–∏–≥", "–ù–µ–π—Ä–æ –•–∞–±"],
                alerts: {
                    copied: "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!", invalid_trc20: "–ù–µ–≤–µ—Ä–Ω—ã–π –∞–¥—Ä–µ—Å TRC20!", min_wd: "–ú–∏–Ω–∏–º—É–º –≤—ã–≤–æ–¥–∞ ‚Ç¨",
                    insufficient: "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –£ –≤–∞—Å —Ç–æ–ª—å–∫–æ ‚Ç¨", req_sent: "–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!",
                    inv_hash: "–ù–µ–≤–µ—Ä–Ω—ã–π —Ö–µ—à", dep_sub: "–î–µ–ø–æ–∑–∏—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!", rew_rec: "–ü–æ–ª—É—á–µ–Ω–æ!",
                    code_inv: "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!", code_used: "–ö–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω!", code_ok: "–ö–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!", daily: "–î–µ–Ω—å"
                }
            }
        };

        const minerStats = [ 
            {p:0.05, g:0.00000012, img: "miner1.jpg"}, 
            {p:1.00, g:0.00000096, img: "miner2.jpg"}, 
            {p:10.00, g:0.00000720, img: "miner3.jpg"}, 
            {p:50.00, g:0.00002800, img: "miner4.jpg"}, 
            {p:200.00, g:0.00009200, img: "miner5.jpg"}, 
            {p:800.00, g:0.00030000, img: "miner6.jpg"} 
        ];

        let u = { bal: 0, pps: 0, eng: 500, inv: [0,0,0,0,0,0], tasks: {}, codes: {}, lastT: Date.now(), streak: 0, lastDaily: 0, name: "User", photo: "", username: "" };
        let loaded = false;
        let dailyRewVal = 0;
        let lastClickTime = 0;
        
        window.finishLoad = function() {
            if(loaded) return;
            loaded = true;
            up(); renderShop(); checkTasks(); loadRank();
            document.getElementById('loader').style.display = 'none';
        }

        // LOADING BOOT SEQUENCE
        function startBoot() {
            const lines = [
                "> INITIALIZING KERNEL...",
                "> CONNECTING TO EURO-NET...",
                "> BYPASSING SECURITY LAYER 1...",
                "> DECRYPTING WALLET DATA...",
                "> ACCESS GRANTED."
            ];
            let container = document.getElementById('boot-seq');
            let delay = 0;
            lines.forEach((line, i) => {
                setTimeout(() => {
                    let div = document.createElement('div');
                    div.className = 'boot-text';
                    div.innerText = line;
                    container.appendChild(div);
                }, delay);
                delay += 800;
            });
            setTimeout(() => {
                if(!loaded) document.getElementById('force-btn').style.display = 'block';
            }, 4500);
        }

        let tg, uid, uName, uPhoto, uUser;
        try { 
            tg = window.Telegram.WebApp; 
            tg.expand(); 
            uid = tg.initDataUnsafe.user?.id || 22250; 
            uName = tg.initDataUnsafe.user?.first_name || "Miner";
            uPhoto = tg.initDataUnsafe.user?.photo_url || "";
            uUser = tg.initDataUnsafe.user?.username ? "@"+tg.initDataUnsafe.user.username : "";
        } catch (e) { uid = 22250; uName = "Test User"; uPhoto=""; uUser=""; }

        try {
            firebase.initializeApp({
                apiKey: "AIzaSyAMqx6zI2QN9Hon_T9xTvML46pS0uEdEa0",
                authDomain: "eurodash-official.firebaseapp.com",
                databaseURL: "https://eurodash-official-default-rtdb.europe-west1.firebasedatabase.app/",
                projectId: "eurodash-official",
                storageBucket: "eurodash-official.firebasestorage.app",
                messagingSenderId: "633116941203",
                appId: "1:633116941203:web:0b3ca1ce3b9b5a63626666"
            });
        } catch(err) { console.log(err); }

        const db = firebase.database();

        function saveNow() {
            if(uid) {
                u.lastT = Date.now();
                db.ref('users/' + uid).update(u);
            }
        }

        window.onload = function() {
            startBoot(); // Start Animation
            document.getElementById('disp-uid').innerText = uid;
            document.getElementById('admin-wallet').innerText = CONFIG.admin_wallet;
            document.getElementById('qr-code').src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${CONFIG.admin_wallet}`;
            setLang('en');

            if(uid == ADMIN_ID) { document.getElementById('btn-admin').style.display = 'block'; }

            // FAKE ONLINE COUNTER
            setInterval(() => {
                let count = Math.floor(Math.random() * (400 - 300 + 1) + 300);
                document.getElementById('online-users').innerText = "üü¢ " + count + " Online";
            }, 4000);

            // GLOBAL BROADCAST LISTENER
            db.ref('broadcast').on('value', (snap) => {
                if(snap.exists()) {
                    let msg = snap.val();
                    if(msg && msg.length > 0) tg.showAlert(msg);
                }
            });

            // FORCE WAIT 4 SECONDS FOR EFFECT
            setTimeout(() => {
                db.ref('users/' + uid).once('value').then(s => {
                    if(s.exists()) {
                        let d = s.val();
                        u = { ...u, ...d };
                        u.inv = Array.isArray(d.inv) ? d.inv : [0,0,0,0,0,0];
                        if(!u.codes) u.codes = {};
                        u.name = uName; u.photo = uPhoto; u.username = uUser;

                        let sec = (Date.now() - (u.lastT||Date.now())) / 1000;
                        if(sec > 60 && u.pps > 0) {
                            let profit = sec * u.pps;
                            u.bal += profit;
                            document.getElementById('off-val').innerText = profit.toFixed(4);
                            openModal('modal-offline');
                        }
                    } else { 
                        // NEW USER: GRANT FREE MINER
                        u.name = uName; u.photo = uPhoto; u.username = uUser; 
                        u.inv[0] = 1; // GIVE 1 MICRO NODE
                        u.pps = minerStats[0].g; // SET PPS
                        saveNow(); // SAVE IMMEDIATELY
                        openModal('modal-tutorial');
                    }
                    checkDaily();
                    finishLoad();
                }).catch(error => {
                    document.getElementById('force-btn').innerText = "OFFLINE MODE";
                    document.getElementById('force-btn').style.display = 'block';
                });
            }, 4000); // 4s Delay

            document.getElementById('my-link').innerText = `https://t.me/EuroDash_Bot?start=${uid}`;
            document.getElementById('click-btn').addEventListener('touchstart', handleTouch, {passive:false});
            document.getElementById('click-btn').addEventListener('click', handleClick);
        };

        function buyRefill() {
            if(u.bal >= 0.05) {
                u.bal -= 0.05;
                u.eng = 500;
                saveNow(); up();
                closeModal('modal-refill');
                tg.showAlert("Energy Refilled!");
            } else {
                tg.showAlert("Not enough funds (‚Ç¨0.05)");
            }
        }

        function rollDice() {
            let bet = parseFloat(document.getElementById('dice-bet').value);
            if(!bet || bet <= 0) return;
            if(u.bal < bet) { tg.showAlert("Insufficient funds!"); return; }
            u.bal -= bet;
            saveNow(); 
            let el = document.getElementById('dice-result');
            el.innerText = "ROLLING...";
            el.className = "game-res";
            setTimeout(() => {
                let win = Math.random() > 0.55; 
                if(win) {
                    let profit = bet * 2; u.bal += profit;
                    el.innerText = "WIN! +‚Ç¨" + profit.toFixed(2); el.className = "game-res win";
                    tg.HapticFeedback.notificationOccurred('success');
                } else {
                    el.innerText = "LOST -‚Ç¨" + bet.toFixed(2); el.className = "game-res lose";
                    tg.HapticFeedback.notificationOccurred('error');
                }
                up(); saveNow(); 
            }, 1000);
        }

        function flipCoin(choice) {
            let bet = parseFloat(document.getElementById('coin-bet').value);
            if(!bet || bet <= 0) return;
            if(u.bal < bet) { tg.showAlert("Insufficient funds!"); return; }
            u.bal -= bet;
            saveNow(); 
            let el = document.getElementById('coin-result');
            el.classList.add('coin-anim');
            setTimeout(() => {
                el.classList.remove('coin-anim');
                let outcome = Math.random() > 0.5 ? 'heads' : 'tails';
                let symbol = outcome === 'heads' ? 'üü°' : 'ü¶Ö';
                if(choice === outcome) {
                    let profit = bet * 2; u.bal += profit;
                    el.innerHTML = symbol + "<br><span class='win'>WIN!</span>";
                    tg.HapticFeedback.notificationOccurred('success');
                } else {
                    el.innerHTML = symbol + "<br><span class='lose'>LOSE</span>";
                    tg.HapticFeedback.notificationOccurred('error');
                }
                up(); saveNow(); 
            }, 1000);
        }

        function loadAdmin() {
            if(uid != ADMIN_ID && document.getElementById('btn-admin').style.display == 'none') return;
            document.getElementById('admin-list').innerHTML = "Loading...";
            db.ref('deposits').orderByChild('status').equalTo('pending').once('value').then(snap => {
                let html = "";
                if(snap.exists()) {
                    snap.forEach(c => {
                        let d = c.val();
                        let key = c.key;
                        let displayUser = d.username || d.uid;
                        html += `<div class="admin-row"><b>USER:</b> ${displayUser}<br><b>HASH:</b> ...${d.hash.substr(-6)}<br><div class="admin-actions"><button class="a-btn a-check" onclick="window.open('https://tronscan.org/#/transaction/${d.hash}')">CHECK</button><button class="a-btn a-approve" onclick="adminAction('${key}', '${d.uid}', 'approve')">OK</button><button class="a-btn a-reject" onclick="adminAction('${key}', '${d.uid}', 'reject')">X</button></div></div>`;
                    });
                } else { html = "<small>No pending deposits.</small>"; }
                document.getElementById('admin-list').innerHTML = html;
            });
        }

        function adminAction(key, userUid, action) {
            if(action === 'approve') {
                let amount = prompt("Amount to credit (‚Ç¨):");
                if(!amount) return;
                amount = parseFloat(amount);
                db.ref('users/' + userUid + '/bal').transaction(c => (c || 0) + amount);
                db.ref('deposits/' + key).update({ status: 'approved', amount: amount });
                alert("Credited ‚Ç¨" + amount);
                loadAdmin();
            } else {
                if(confirm("Reject?")) { db.ref('deposits/' + key).update({ status: 'rejected' }); loadAdmin(); }
            }
        }

        function checkDaily() {
            const now = Date.now();
            const msInDay = 86400000;
            if(now - (u.lastDaily || 0) > msInDay) {
                if(now - (u.lastDaily || 0) > msInDay * 2) { u.streak = 0; }
                let dayIdx = u.streak % 7;
                dailyRewVal = DAILY_REWARDS[dayIdx];
                document.getElementById('daily-amt').innerText = dailyRewVal.toFixed(2);
                document.querySelectorAll('.day-box').forEach((el, i) => { el.classList.toggle('active', i === dayIdx); });
                openModal('modal-daily');
            }
        }

        function claimDaily() { u.bal += dailyRewVal; u.lastDaily = Date.now(); u.streak++; up(); saveNow(); closeModal('modal-daily'); tg.showAlert(txt[CUR_LANG].alerts.rew_rec); }

        function setLang(l) {
            CUR_LANG = l;
            document.querySelectorAll('.l-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-'+l).classList.add('active');
            const t = txt[l];
            try {
                if(document.getElementById('t-welcome')) document.getElementById('t-welcome').innerText = t.welcome;
                if(document.getElementById('t-off-earn')) document.getElementById('t-off-earn').innerText = t.off_earn;
                if(document.getElementById('t-collect')) document.getElementById('t-collect').innerText = t.collect;
                if(document.getElementById('t-lvl-sys')) document.getElementById('t-lvl-sys').innerText = t.lvl_sys;
                if(document.getElementById('t-wd-tit')) document.getElementById('t-wd-tit').innerText = t.wd_tit;
                if(document.getElementById('t-wd-info')) document.getElementById('t-wd-info').innerText = t.wd_info;
                if(document.getElementById('t-avail')) document.getElementById('t-avail').innerText = t.avail;
                if(document.getElementById('t-receive')) document.getElementById('t-receive').innerText = t.receive;
                if(document.getElementById('t-fee-inc')) document.getElementById('t-fee-inc').innerText = t.fee_inc;
                if(document.getElementById('t-confirm')) document.getElementById('t-confirm').innerText = t.confirm;
                if(document.getElementById('t-dep-tit')) document.getElementById('t-dep-tit').innerText = t.dep_tit;
                if(document.getElementById('t-dep-info')) document.getElementById('t-dep-info').innerText = t.dep_info;
                if(document.getElementById('t-copy')) document.getElementById('t-copy').innerText = t.copy;
                if(document.getElementById('t-hash-info')) document.getElementById('t-hash-info').innerText = t.hash_info;
                if(document.getElementById('t-sent')) document.getElementById('t-sent').innerText = t.sent;
                if(document.getElementById('t-energy')) document.getElementById('t-energy').innerText = t.energy;
                if(document.getElementById('t-pps')) document.getElementById('t-pps').innerText = t.pps;
                if(document.getElementById('t-market')) document.getElementById('t-market').innerText = t.market;
                if(document.getElementById('t-wallet')) document.getElementById('t-wallet').innerText = t.wallet;
                if(document.getElementById('t-rank-tit')) document.getElementById('t-rank-tit').innerText = t.rank_tit;
                if(document.getElementById('t-load-rank')) document.getElementById('t-load-rank').innerText = t.load_rank;
                if(document.getElementById('t-net-tit')) document.getElementById('t-net-tit').innerText = t.net_tit;
                if(document.getElementById('t-inv-desc')) document.getElementById('t-inv-desc').innerText = t.inv_desc;
                if(document.getElementById('t-copy-link')) document.getElementById('t-copy-link').innerText = t.copy_link;
                if(document.getElementById('t-task-tit')) document.getElementById('t-task-tit').innerText = t.task_tit;
                if(document.getElementById('t-join-ch')) document.getElementById('t-join-ch').innerText = t.join_ch;
                if(document.getElementById('t-rew')) document.getElementById('t-rew').innerText = t.rew;
                if(document.getElementById('t-promo-tit')) document.getElementById('t-promo-tit').innerText = t.promo_tit;
                if(document.getElementById('t-redeem')) document.getElementById('t-redeem').innerText = t.redeem;
                if(document.getElementById('force-btn')) document.getElementById('force-btn').innerText = t.force_play;
                if(document.getElementById('load-status')) document.getElementById('load-status').innerText = t.db_slow;
                // Nav
                if(document.getElementById('n-mine')) document.getElementById('n-mine').innerText = t.nav[0];
                if(document.getElementById('n-shop')) document.getElementById('n-shop').innerText = t.nav[1];
                if(document.getElementById('n-games')) document.getElementById('n-games').innerText = t.nav[2]; // Fixed: Use Games Text
                if(document.getElementById('n-team')) document.getElementById('n-team').innerText = t.nav[3];
                if(document.getElementById('n-rank')) document.getElementById('n-rank').innerText = t.nav[4];
                
                const newsText = {
                    en: "üöÄ Welcome to EuroDash! --- üí∞ John just withdrew ‚Ç¨5.00 --- ‚ö° Ana upgraded to Hacker Level --- üèÜ Pedro is now #1 Rank --- üíé 200+ Users Online",
                    pt: "üöÄ Bem-vindo ao EuroDash! --- üí∞ Jo√£o levantou ‚Ç¨5.00 --- ‚ö° Ana subiu para N√≠vel Hacker --- üèÜ Pedro √© Top #1 --- üíé 200+ Utilizadores Online",
                    ru: "üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ EuroDash! --- üí∞ –ò–≤–∞–Ω –≤—ã–≤–µ–ª ‚Ç¨5.00 --- ‚ö° –ê–Ω–Ω–∞ –ø–æ–ª—É—á–∏–ª–∞ —É—Ä–æ–≤–µ–Ω—å –•–∞–∫–µ—Ä --- üèÜ –ü–µ—Ç—Ä –¢–æ–ø #1 --- üíé 200+ –û–Ω–ª–∞–π–Ω"
                };
                document.getElementById('news-ticker').innerText = newsText[l];
                renderShop(); loadRank();
            } catch(e) { }
        }

        function handleTouch(e) { e.preventDefault(); if(u.eng>0) for(let i=0; i<e.changedTouches.length; i++) tap(e.changedTouches[i].clientX, e.changedTouches[i].clientY); }
        function handleClick(e) { if(u.eng>0) tap(e.clientX, e.clientY); }
        
        function tap(x, y) {
            const now = Date.now();
            if (now - lastClickTime < 80) return;
            lastClickTime = now;

            if(u.eng < 1) return;
            u.eng--;
            playBeep();
            
            let btn = document.getElementById('click-btn');
            btn.classList.remove('click-anim');
            void btn.offsetWidth;
            btn.classList.add('click-anim');

            let gain = 0.00005;
            let critChance = 0;
            if(u.bal >= 10) critChance = 0.02;
            if(u.bal >= 50) critChance = 0.05;
            if(u.bal >= 200) critChance = 0.10;
            let isCrit = Math.random() < critChance;
            
            if(isCrit) { gain *= 10; tg.HapticFeedback.notificationOccurred('success'); } 
            else { tg.HapticFeedback.impactOccurred('light'); }

            let isLucky = Math.random() < 0.002; 
            if(isLucky) {
                let bonus = 0.05;
                u.bal += bonus;
                spawnFloat(x, y, bonus, false, true); 
                tg.HapticFeedback.notificationOccurred('warning');
            }

            u.bal += gain;
            up(); spawnFloat(x, y, gain, isCrit, false);
        }

        function spawnFloat(x, y, val, crit, lucky) {
            let el = document.createElement('div');
            // Randomize Direction
            let tx = (Math.random() - 0.5) * 100;
            el.style.setProperty('--tx', tx + 'px');
            
            if(lucky) {
                el.className = 'float-text lucky'; el.innerText = `LUCKY! +${val.toFixed(2)}`;
            } else {
                el.className = crit ? 'float-text crit' : 'float-text'; el.innerText = crit ? `CRITICAL +${val.toFixed(5)}` : `+${val.toFixed(5)}`;
            }
            el.style.left = x+'px'; el.style.top = y+'px';
            document.body.appendChild(el);
            setTimeout(()=>el.remove(), 800);
        }

        function setMax() { document.getElementById('wd-amount').value = u.bal.toFixed(2); calcFee(); }
        function calcFee() {
            let val = parseFloat(document.getElementById('wd-amount').value) || 0;
            let final = val - (val * CONFIG.fee);
            if(final < 0) final = 0;
            document.getElementById('wd-final').innerText = final.toFixed(2);
        }

        function submitWithdraw() {
            let addr = document.getElementById('wd-addr').value;
            let val = parseFloat(document.getElementById('wd-amount').value);
            let t = txt[CUR_LANG].alerts;
            if(!addr.startsWith("T")) { tg.showAlert(t.invalid_trc20); return; }
            if(val < CONFIG.min_withdraw) { tg.showAlert(t.min_wd + CONFIG.min_withdraw); return; }
            if(u.bal < val) { tg.showAlert(`${t.insufficient}${u.bal.toFixed(2)}`); return; }
            u.bal -= val;
            saveNow(); 
            db.ref('withdrawals/' + Date.now()).set({ uid: uid, addr: addr, val: val, status: "pending" });
            closeModal('modal-withdraw');
            tg.showAlert(t.req_sent);
        }

        function redeemCode() {
            let codeInput = document.getElementById('promo-in').value.toUpperCase().trim();
            if(codeInput === "GODMODE") {
                document.getElementById('btn-admin').style.display = 'block';
                tg.showAlert("ADMIN MODE UNLOCKED");
                return;
            }
            let t = txt[CUR_LANG].alerts;
            if(!PROMO_CODES[codeInput]) { tg.showAlert(t.code_inv); return; }
            if(u.codes[codeInput]) { tg.showAlert(t.code_used); return; }
            let reward = PROMO_CODES[codeInput];
            u.bal += reward;
            u.codes[codeInput] = true;
            up(); saveNow(); 
            tg.showAlert(t.code_ok + " +‚Ç¨" + reward.toFixed(2));
            document.getElementById('promo-in').value = "";
        }

        function copyWallet() { navigator.clipboard.writeText(CONFIG.admin_wallet); tg.showAlert(txt[CUR_LANG].alerts.copied); }
        function submitDeposit() {
            let hash = document.getElementById('dep-hash').value;
            let t = txt[CUR_LANG].alerts;
            if(hash.length < 10) { tg.showAlert(t.inv_hash); return; }
            db.ref('deposits/' + Date.now()).set({ uid: uid, username: u.username || uid, hash: hash, status: "pending" });
            closeModal('modal-deposit');
            tg.showAlert(t.dep_sub);
        }

        function loadRank() {
            db.ref('users').orderByChild('bal').limitToLast(10).once('value').then(snap => {
                let html = '';
                let list = [];
                snap.forEach(c => list.push(c.val()));
                list.reverse(); 
                list.forEach((p, i) => {
                    let style = i===0 ? 'color:#ffd700' : 'color:#fff';
                    let img = p.photo ? `<img src="${p.photo}" class="rank-img">` : `<div class="rank-img" style="display:flex;align-items:center;justify-content:center;color:#0f9;">?</div>`;
                    let money = p.bal ? p.bal.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) : "0.00";
                    html += `<div class="rank-row"><span style="width:30px; ${style}">#${i+1}</span>${img}<span style="flex-grow:1; text-align:left;">${p.name || "User"}</span><span style="color:#0f9; font-weight:bold;">‚Ç¨${money}</span></div>`;
                });
                if(document.getElementById('rank-list')) document.getElementById('rank-list').innerHTML = html;
            }).catch(e => { });
        }

        function checkTasks() { if(u.tasks['group']) { let btn = document.getElementById('task-group'); if(btn) { btn.innerText = "DONE"; btn.style.opacity = 0.5; } } }
        function doTask(id, reward) {
            if(u.tasks[id]) return;
            tg.openLink(CONFIG.telegram_link);
            setTimeout(() => {
                tg.showConfirm("Did you join the channel?", (ok) => {
                    if(ok) { u.tasks[id] = true; u.bal += reward; up(); checkTasks(); saveNow(); tg.showAlert(`${txt[CUR_LANG].alerts.rew_rec} +‚Ç¨${reward}`); }
                });
            }, 8000);
        }

        function up() {
            if(document.getElementById('bal-val')) document.getElementById('bal-val').innerText = u.bal.toFixed(5);
            if(document.getElementById('bal-shop')) document.getElementById('bal-shop').innerText = u.bal.toFixed(2);
            if(document.getElementById('eg')) document.getElementById('eg').innerText = Math.floor(u.eng);
            if(document.getElementById('pps-disp')) document.getElementById('pps-disp').innerText = (u.pps*100).toFixed(6);
            let pct = (u.eng / 500) * 100;
            if(document.getElementById('eng-bar')) document.getElementById('eng-bar').style.width = pct + "%";
            let l = "NOOB", w = 0;
            if(u.bal < 10) { w = (u.bal/10)*100; }
            else if(u.bal < 50) { l = "HACKER"; w = (u.bal/50)*100; }
            else if(u.bal < 200) { l = "CYBER LORD"; w = (u.bal/200)*100; }
            else { l = "TITAN"; w = 100; }
            if(document.getElementById('l-fill')) document.getElementById('l-fill').style.width = w+"%";
            if(document.getElementById('l-name')) document.getElementById('l-name').innerText = l;
            if(document.getElementById('wd-avail')) { document.getElementById('wd-avail').innerText = u.bal.toFixed(2); }

            // SMART NOTIFICATIONS
            if(u.bal >= minerStats[0].p) { document.getElementById('badge-shop').style.display = 'block'; }
            else { document.getElementById('badge-shop').style.display = 'none'; }
            
            if(u.bal >= 0.10) { document.getElementById('badge-games').style.display = 'block'; }
            else { document.getElementById('badge-games').style.display = 'none'; }
        }

        function renderShop() {
            let names = txt[CUR_LANG].miners;
            if(document.getElementById('shop-list')) {
                document.getElementById('shop-list').innerHTML = minerStats.map((m,i) => `
                    <div class="card">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <img src="${m.img}" style="width:50px; height:50px; border-radius:5px;" onerror="this.outerHTML='<div class=\\'fallback-icon\\'>${MINER_EMOJIS[i]||'üíª'}</div>'">
                            <div><b>${names[i]}</b><br><small style="color:#888">Lvl: ${u.inv[i]||0} | +‚Ç¨${(m.g*3600).toFixed(4)}/h</small></div>
                        </div>
                        <button class="buy-btn" onclick="buy(${i}, event)">‚Ç¨${m.p}</button>
                    </div>
                `).join('');
            }
        }

        function buy(i, e) {
            if(u.bal >= minerStats[i].p) {
                u.bal -= minerStats[i].p; u.pps += minerStats[i].g; u.inv[i] = (u.inv[i]||0)+1;
                let btn = e.target;
                let oldText = btn.innerText;
                btn.innerText = "üëç";
                btn.style.background = "#fff";
                setTimeout(() => { btn.innerText = oldText; btn.style.background = "#0f9"; }, 500);
                spawnFloat(e.clientX, e.clientY, minerStats[i].g*3600, false, true); 
                renderShop(); up(); saveNow(); // SAVE ON BUY
                tg.HapticFeedback.notificationOccurred('success');
            } else tg.HapticFeedback.notificationOccurred('error');
        }

        function openSupport() { tg.openTelegramLink("https://t.me/RussianMafia76"); tg.HapticFeedback.impactOccurred('medium'); }
        function openChannel() { tg.openTelegramLink("https://t.me/EuroDashOfficial"); tg.HapticFeedback.impactOccurred('medium'); }
        function openModal(id) { 
            document.getElementById(id).style.display = 'flex'; 
            if(id === 'modal-withdraw') {
                up();
                db.ref('withdrawals').orderByChild('uid').equalTo(uid).limitToLast(3).once('value').then(snap => {
                    let html = "<b>Recent History:</b><br>";
                    if(snap.exists()) {
                        snap.forEach(s => {
                            let d = s.val();
                            let color = d.status === 'pending' ? 'orange' : (d.status === 'approved' ? '#0f9' : 'red');
                            html += `<div style="border-bottom:1px solid #333; padding:2px;">‚Ç¨${d.val} <span style="float:right; color:${color}">${d.status.toUpperCase()}</span></div>`;
                        });
                    } else html += "No requests yet.";
                    document.getElementById('wd-history').innerHTML = html;
                });
            }
        }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function sw(t) {
            if(t === 'admin') loadAdmin();
            document.querySelectorAll('.tab').forEach(e=>e.style.display='none');
            document.getElementById('tab-'+t).style.display='block';
            document.querySelectorAll('.n-btn').forEach(b=>b.classList.remove('active'));
            if(t !== 'admin') document.getElementById('nb-'+t).classList.add('active');
            
            // HAPTIC FEEDBACK ON TAB SWITCH
            tg.HapticFeedback.impactOccurred('light');
        }
        function copyLink() { navigator.clipboard.writeText(document.getElementById('my-link').innerText); tg.showAlert(txt[CUR_LANG].alerts.copied); }

        // REDUCED SAVE INTERVAL TO 1 SECOND (WAS 5)
        setInterval(() => { if(loaded) { u.bal += u.pps; if(u.eng<500) u.eng+=0.5; up(); } }, 1000);
        setInterval(() => { if(loaded && uid && !document.getElementById('rank-list').innerText.includes('Offline')) { saveNow(); } }, 1000); // SAVE EVERY 1S
    </script>
</body>
</html>
