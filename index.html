<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EURODASH OFFICIAL</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap');
        
        /* --- CYBERPUNK THEME --- */
        body { 
            background-color: #050505;
            background-image: linear-gradient(rgba(0, 255, 153, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 255, 153, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            color: #fff; font-family: 'Rajdhani', sans-serif; margin: 0; text-align: center; overflow: hidden; user-select: none; -webkit-tap-highlight-color: transparent; 
        }
        body::after { content: ""; position: absolute; top:0; left:0; width:100%; height:100%; background: radial-gradient(circle, transparent 40%, #000 100%); pointer-events: none; z-index: -1; }

        /* --- UI HELPERS --- */
        .tab { display: none; padding: 20px; padding-top: 60px; padding-bottom: 90px; height: 85vh; overflow-y: auto; scrollbar-width: none; }
        .buy-btn { background: #0f9; color: #000; border: none; padding: 8px 20px; border-radius: 4px; font-weight: bold; font-family: 'Rajdhani'; cursor: pointer; text-transform: uppercase; font-size: 14px; box-shadow: 0 0 10px rgba(0,255,153,0.2); }
        .buy-btn:active { transform: scale(0.95); }
        .w-btn { background: #ff3333; color: #fff; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px rgba(255,0,0,0.3); }
        .dep-btn { background: #00ccff; color: #000; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px rgba(0,204,255,0.3); }

        /* --- MODALS (POPUPS) --- */
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index: 200; align-items:center; justify-content:center; flex-direction:column; backdrop-filter: blur(5px); }
        .modal-box { background: #111; border: 1px solid #0f9; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 0 30px rgba(0,255,153,0.1); width: 85%; max-width: 350px; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; color: #555; font-size: 24px; cursor: pointer; }
        .inp { width: 90%; background: #000; border: 1px solid #333; color: #fff; padding: 10px; margin: 10px 0; border-radius: 5px; font-family: monospace; text-align: center; }
        .inp:focus { border-color: #0f9; outline: none; }

        /* --- LOADING --- */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: monospace; }
        .glitch { font-size: 40px; font-weight: bold; color: #0f9; text-shadow: 2px 2px #f0f; animation: glitch 1s infinite; letter-spacing: 5px; }
        @keyframes glitch { 0% { transform: translate(0); } 20% { transform: translate(-2px, 2px); } 40% { transform: translate(-2px, -2px); } 60% { transform: translate(2px, 2px); } 80% { transform: translate(2px, -2px); } 100% { transform: translate(0); } }

        /* --- MAIN ELEMENTS --- */
        .main-img-con { position: relative; width: 220px; height: 220px; margin: 0 auto; display: flex; align-items: center; justify-content: center; }
        .main-img { width: 100%; height: 100%; border-radius: 50%; border: 2px solid rgba(0,255,153,0.3); box-shadow: 0 0 30px rgba(0,255,153,0.2); cursor: pointer; z-index: 10; transition: transform 0.05s; -webkit-user-drag: none; }
        .main-img:active { transform: scale(0.96); border-color: #0f9; box-shadow: 0 0 50px rgba(0,255,153,0.6); }
        .float-text { position: absolute; color: #fff; font-weight: bold; font-size: 24px; pointer-events: none; animation: floatUp 0.8s ease-out forwards; text-shadow: 0 0 5px #0f9; z-index: 20; }
        .crit { color: #ffd700 !important; font-size: 32px !important; text-shadow: 0 0 15px #ffaa00 !important; z-index: 25; }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-100px) scale(1.5); opacity: 0; } }

        /* --- LEVEL BAR --- */
        .lvl-con { width: 60%; margin: 0 auto 5px auto; background: #111; height: 6px; border-radius: 3px; position: relative; border: 1px solid #333; display: inline-block; vertical-align: middle; }
        .lvl-fill { height: 100%; background: linear-gradient(90deg, #0f9, #00ffff); width: 0%; border-radius: 3px; transition: width 0.5s; box-shadow: 0 0 10px #0f9; }
        .info-btn { background: #333; color: #fff; border: 1px solid #555; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; cursor: pointer; margin-left: 5px; display: inline-flex; align-items: center; justify-content: center; }

        /* --- CARDS --- */
        .card { background: rgba(10,10,10,0.8); border: 1px solid #222; border-left: 3px solid #0f9; border-radius: 10px; padding: 15px; margin-bottom: 12px; text-align: left; display: flex; align-items: center; justify-content: space-between; backdrop-filter: blur(5px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .market-header { background: #111; padding: 15px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        
        /* --- RANKING --- */
        .rank-row { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #222; }
        .rank-1 { color: #ffd700; text-shadow: 0 0 10px #ffd700; }
        
        /* --- NAV --- */
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; background: rgba(5,5,5,0.95); border-top: 1px solid #222; padding-bottom: 20px; padding-top: 10px; z-index: 100; backdrop-filter: blur(10px); }
        .n-btn { flex: 1; color: #444; font-size: 10px; font-weight: bold; display: flex; flex-direction: column; align-items: center; gap: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .n-btn.active { color: #0f9; text-shadow: 0 0 10px rgba(0,255,153,0.6); }
        .n-icon { font-size: 22px; margin-bottom: 2px; }
    </style>
</head>
<body>

    <div id="loader">
        <div class="glitch">EURODASH</div>
        <div style="color:#0f9; font-size:12px; margin-top:20px;">INITIALIZING SYSTEM...</div>
    </div>

    <div id="modal-offline" class="modal">
        <div class="modal-box">
            <h2 style="color:#fff;">WELCOME BACK</h2>
            <p style="color:#aaa;">Offline Earnings:</p>
            <h1 style="color:#0f9; font-size:40px;">+‚Ç¨<span id="off-val">0.00</span></h1>
            <button class="buy-btn" onclick="closeModal('modal-offline')">COLLECT</button>
        </div>
    </div>

    <div id="modal-levels" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-levels')">&times;</span>
            <h3 style="color:#0f9">LEVEL SYSTEM</h3>
            <div style="text-align:left; font-size:14px; color:#ddd; line-height:1.6;">
                <b style="color:#fff">1. NOOB (‚Ç¨0-10)</b><br>Basic mining speed.<br><br>
                <b style="color:#00ffff">2. HACKER (‚Ç¨10-50)</b><br>+2% Critical Chance.<br><br>
                <b style="color:#ff00ff">3. CYBER LORD (‚Ç¨50-200)</b><br>+5% Critical Chance.<br><br>
                <b style="color:#ffd700">4. TITAN (‚Ç¨200+)</b><br>+10% Critical Chance + Max Energy.
            </div>
        </div>
    </div>

    <div id="modal-withdraw" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-withdraw')">&times;</span>
            <h3 style="color:#ff3333">WITHDRAW (TRC20)</h3>
            <p style="font-size:12px; color:#888;">Min: ‚Ç¨1.00 | Fee: 2%</p>
            <input type="text" id="wd-addr" class="inp" placeholder="Paste TRC20 Address">
            <input type="number" id="wd-amount" class="inp" placeholder="Amount (‚Ç¨)" oninput="calcFee()">
            <div style="font-size:13px; margin:10px 0;">
                Receive: <b style="color:#fff">‚Ç¨<span id="wd-final">0.00</span></b>
            </div>
            <button class="w-btn" onclick="submitWithdraw()">CONFIRM</button>
        </div>
    </div>

    <div id="modal-deposit" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-deposit')">&times;</span>
            <h3 style="color:#00ccff">DEPOSIT (USDT)</h3>
            <p style="font-size:12px; color:#aaa;">Send USDT (TRC20) to this address:</p>
            <div style="background:#222; padding:10px; font-size:10px; word-break:break-all; color:#0f9; border:1px dashed #555; user-select:text;" id="admin-wallet">...</div>
            <button class="buy-btn" style="margin-top:5px; font-size:10px;" onclick="copyWallet()">COPY ADDRESS</button>
            <hr style="border-color:#333; margin:15px 0;">
            <p style="font-size:12px; color:#aaa;">Paste Transaction Hash (TXID):</p>
            <input type="text" id="dep-hash" class="inp" placeholder="Transaction Hash">
            <button class="dep-btn" onclick="submitDeposit()">I SENT IT</button>
        </div>
    </div>

    <div id="tab-core" class="tab" style="display:block;">
        <div id="balance" style="font-size:52px; font-weight:700; margin-top:20px;">‚Ç¨<span id="bal-val">0.00000</span></div>
        <div style="margin-bottom:20px;">
            <div class="lvl-con"><div class="lvl-fill" id="l-fill"></div></div>
            <button class="info-btn" onclick="openModal('modal-levels')">?</button>
            <div style="font-size:12px; color:#aaa; letter-spacing:2px;" id="l-name">NOOB</div>
        </div>

        <div class="main-img-con">
            <img src="image_3.jpg" class="main-img" id="click-btn" onerror="this.src='https://via.placeholder.com/220/000/0f9?text=TAP'">
        </div>

        <div style="margin-top:40px; display:flex; justify-content:center; gap:30px;">
            <div><b style="color:#0f9; font-size:20px;">‚ö° <span id="eg">500</span></b><br><small style="color:#555">ENERGY</small></div>
            <div><b style="color:#0f9; font-size:20px;">üöÄ <span id="pps-disp">0</span></b><br><small style="color:#555">‚Ç¨/SEC</small></div>
        </div>
    </div>

    <div id="tab-shop" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;">MARKET</h2>
        <div class="market-header">
            <div style="text-align:left;">
                <span style="font-size:12px; color:#888;">WALLET</span><br>
                <b style="font-size:18px;">‚Ç¨<span id="bal-shop">0.00</span></b>
            </div>
            <div style="display:flex; gap:5px;">
                <button class="dep-btn" onclick="openModal('modal-deposit')">DEP</button>
                <button class="w-btn" onclick="openModal('modal-withdraw')">W/D</button>
            </div>
        </div>
        <div id="shop-list"></div>
    </div>

    <div id="tab-rank" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;">TOP INVESTORS</h2>
        <div style="background:#111; border-radius:10px; padding:10px; border:1px solid #333;" id="rank-list">
            <div style="padding:20px; color:#555;">Loading real data...</div>
        </div>
    </div>

    <div id="tab-friends" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;">NETWORK</h2>
        <div class="card" style="display:block; text-align:center;">
            <h1>üíé</h1>
            <p style="color:#aaa;">Invite friends & earn 5% of their mining!</p>
            <div style="background:#000; padding:10px; color:#0f9; font-size:12px; border:1px dashed #333; margin-bottom:10px; word-break:break-all;" id="my-link">...</div>
            <button onclick="copyLink()" class="buy-btn" style="width:100%">COPY LINK</button>
        </div>
    </div>

    <div id="tab-earn" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;">TASKS</h2>
        <div class="card">
            <div><b style="color:#fff">Join Official Channel</b><br><small style="color:#0f9">+‚Ç¨0.10 Reward</small></div>
            <button class="buy-btn" id="task-group" onclick="doTask('group', 0.10)">START</button>
        </div>
    </div>

    <div class="nav">
        <div class="n-btn active" id="nb-core" onclick="sw('core')"><span class="n-icon">‚ö°</span><span>MINE</span></div>
        <div class="n-btn" id="nb-shop" onclick="sw('shop')"><span class="n-icon">üõçÔ∏è</span><span>SHOP</span></div>
        <div class="n-btn" id="nb-rank" onclick="sw('rank')"><span class="n-icon">üèÜ</span><span>RANK</span></div>
        <div class="n-btn" id="nb-friends" onclick="sw('friends')"><span class="n-icon">üë•</span><span>TEAM</span></div>
        <div class="n-btn" id="nb-earn" onclick="sw('earn')"><span class="n-icon">üéØ</span><span>EARN</span></div>
    </div>

    <script>
        // ==========================================
        // CONFIGURA√á√ïES
        // ==========================================
        const CONFIG = {
            telegram_link: "https://t.me/EuroDashOfficial", 
            admin_wallet: "TWk7a3xLdEX3XWRGWaBHT1mbc8kq3JYZJw", 
            min_withdraw: 1.00,
            fee: 0.02 
        };

        const miners = [
            {p:0.05, g:0.00000012, img: "miner1.jpg", n:"Micro Node"}, 
            {p:1.00, g:0.00000096, img: "miner2.jpg", n:"Blade Rack"}, 
            {p:10.00, g:0.00000720, img: "miner3.jpg", n:"Turbo Server"}, 
            {p:50.00, g:0.00002800, img: "miner4.jpg", n:"Cyber Station"}, 
            {p:200.00, g:0.00009200, img: "miner5.jpg", n:"Quantum Rig"}, 
            {p:800.00, g:0.00030000, img: "miner6.jpg", n:"Neural Hub"}, 
            {p:3000.00, g:0.00099000, img: "miner7.jpg", n:"Titan Core"}
        ];

        let u = { bal: 0, pps: 0, eng: 500, inv: [0,0,0,0,0,0,0], tasks: {}, lastT: Date.now(), name: "User" };
        let loaded = false;
        
        let tg, uid, uName;
        try {
            tg = window.Telegram.WebApp;
            tg.expand();
            uid = tg.initDataUnsafe.user?.id || 22250;
            uName = tg.initDataUnsafe.user?.first_name || "Miner";
        } catch (e) {
            uid = 22250; uName = "Test User";
        }

        // --- FIREBASE OFICIAL (TUAS CHAVES) ---
        try {
            firebase.initializeApp({
                apiKey: "AIzaSyAMqx6zI2QN9Hon_T9xTvML46pS0uEdEa0",
                authDomain: "eurodash-official.firebaseapp.com",
                databaseURL: "https://eurodash-official-default-rtdb.europe-west1.firebasedatabase.app", // TESTA ESTE LINK SE DER ERRO
                projectId: "eurodash-official",
                storageBucket: "eurodash-official.firebasestorage.app",
                messagingSenderId: "633116941203",
                appId: "1:633116941203:web:0b3ca1ce3b9b5a63626666"
            });
        } catch(err) {
            console.log("Firebase Init Error");
        }

        const db = firebase.database();

        window.onload = function() {
            try {
                document.getElementById('admin-wallet').innerText = CONFIG.admin_wallet;
                document.getElementById('loader').innerHTML += '<br><small style="color:yellow; font-size:10px;">Establishing Connection...</small>';

                setTimeout(() => {
                    if(!loaded) {
                        // FALLBACK: Se falhar a conex√£o, entra na mesma
                        finishLoad();
                    }
                }, 5000);

                db.ref('users/' + uid).once('value')
                    .then(s => {
                        if(s.exists()) {
                            let d = s.val();
                            u = { ...u, ...d };
                            u.inv = Array.isArray(d.inv) ? d.inv : [0,0,0,0,0,0,0];
                            
                            let sec = (Date.now() - (u.lastT||Date.now())) / 1000;
                            if(sec > 60 && u.pps > 0) {
                                let profit = sec * u.pps;
                                u.bal += profit;
                                document.getElementById('off-val').innerText = profit.toFixed(4);
                                openModal('modal-offline');
                            }
                        } else {
                            u.name = uName; 
                        }
                        finishLoad();
                    })
                    .catch(error => {
                        // Se der erro (ex: regras), entra na mesma
                        finishLoad(); 
                    });

                document.getElementById('my-link').innerText = `https://t.me/EuroDash_Bot?start=${uid}`;
                document.getElementById('click-btn').addEventListener('touchstart', handleTouch, {passive:false});
                document.getElementById('click-btn').addEventListener('click', handleClick);

            } catch (globalErr) {
                alert("CRASH: " + globalErr.message);
                finishLoad();
            }
        };

        function finishLoad() {
            if(loaded) return;
            loaded = true;
            up(); renderShop(); checkTasks(); loadRank();
            document.getElementById('loader').style.display = 'none';
        }

        function handleTouch(e) { e.preventDefault(); if(u.eng>0) for(let i=0; i<e.changedTouches.length; i++) tap(e.changedTouches[i].clientX, e.changedTouches[i].clientY); }
        function handleClick(e) { if(u.eng>0) tap(e.clientX, e.clientY); }
        
        function tap(x, y) {
            if(u.eng < 1) return;
            u.eng--;
            let gain = 0.00005;
            let critChance = 0;
            if(u.bal >= 10) critChance = 0.02;
            if(u.bal >= 50) critChance = 0.05;
            if(u.bal >= 200) critChance = 0.10;

            let isCrit = Math.random() < critChance;
            if(isCrit) { gain *= 10; tg.HapticFeedback.notificationOccurred('success'); }
            else { tg.HapticFeedback.impactOccurred('light'); }

            u.bal += gain;
            up();
            spawnFloat(x, y, gain, isCrit);
        }

        function spawnFloat(x, y, val, crit) {
            let el = document.createElement('div');
            el.className = crit ? 'float-text crit' : 'float-text';
            el.innerText = crit ? `CRITICAL +${val.toFixed(5)}` : `+${val.toFixed(5)}`;
            el.style.left = x+'px'; el.style.top = y+'px';
            document.body.appendChild(el);
            setTimeout(()=>el.remove(), 800);
        }

        function calcFee() {
            let val = parseFloat(document.getElementById('wd-amount').value) || 0;
            let final = val - (val * CONFIG.fee);
            document.getElementById('wd-final').innerText = final.toFixed(2);
        }

        function submitWithdraw() {
            let addr = document.getElementById('wd-addr').value;
            let val = parseFloat(document.getElementById('wd-amount').value);
            if(!addr.startsWith("T")) { tg.showAlert("Invalid TRC20 Address!"); return; }
            if(val < CONFIG.min_withdraw) { tg.showAlert(`Min withdraw is ‚Ç¨${CONFIG.min_withdraw}`); return; }
            if(u.bal < val) { tg.showAlert("Insufficient Balance!"); return; }

            u.bal -= val;
            up();
            db.ref('withdrawals/' + Date.now()).set({ uid: uid, addr: addr, val: val, status: "pending" });
            closeModal('modal-withdraw');
            tg.showAlert("Request Sent!");
        }

        function copyWallet() { navigator.clipboard.writeText(CONFIG.admin_wallet); tg.showAlert("Address Copied!"); }
        function submitDeposit() {
            let hash = document.getElementById('dep-hash').value;
            if(hash.length < 10) { tg.showAlert("Invalid Hash"); return; }
            db.ref('deposits/' + Date.now()).set({ uid: uid, hash: hash, status: "pending" });
            closeModal('modal-deposit');
            tg.showAlert("Deposit Submitted!");
        }

        function loadRank() {
            db.ref('users').orderByChild('bal').limitToLast(10).once('value').then(snap => {
                let html = '';
                let list = [];
                snap.forEach(c => list.push(c.val()));
                list.reverse(); 
                list.forEach((p, i) => {
                    let style = i===0 ? 'color:#ffd700' : 'color:#fff';
                    html += `<div class="rank-row"><span style="width:30px; ${style}">#${i+1}</span><span style="flex-grow:1; text-align:left;">${p.name || "User"}</span><span style="color:#0f9; font-weight:bold;">‚Ç¨${(p.bal||0).toFixed(2)}</span></div>`;
                });
                document.getElementById('rank-list').innerHTML = html;
            }).catch(e => {
                // Ignore rank errors
            });
        }

        function doTask(id, reward) {
            if(u.tasks[id]) return;
            tg.openLink(CONFIG.telegram_link);
            setTimeout(() => {
                tg.showConfirm("Did you join the channel?", (ok) => {
                    if(ok) {
                        u.tasks[id] = true; u.bal += reward; up();
                        document.getElementById('task-group').innerText = "DONE";
                        document.getElementById('task-group').style.opacity = 0.5;
                        tg.showAlert(`+‚Ç¨${reward} Received!`);
                    }
                });
            }, 8000);
        }

        function up() {
            document.getElementById('bal-val').innerText = u.bal.toFixed(5);
            document.getElementById('bal-shop').innerText = u.bal.toFixed(2);
            document.getElementById('eg').innerText = Math.floor(u.eng);
            document.getElementById('pps-disp').innerText = (u.pps*100).toFixed(6);
            let l = "NOOB", w = 0;
            if(u.bal < 10) { w = (u.bal/10)*100; }
            else if(u.bal < 50) { l = "HACKER"; w = (u.bal/50)*100; }
            else if(u.bal < 200) { l = "CYBER LORD"; w = (u.bal/200)*100; }
            else { l = "TITAN"; w = 100; }
            document.getElementById('l-fill').style.width = w+"%";
            document.getElementById('l-name').innerText = l;
        }

        function renderShop() {
            document.getElementById('shop-list').innerHTML = miners.map((m,i) => `
                <div class="card">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <img src="${m.img}" style="width:50px; height:50px; border-radius:5px;" onerror="this.src='https://via.placeholder.com/50'">
                        <div><b>${m.n}</b><br><small style="color:#888">Lvl: ${u.inv[i]||0} | +‚Ç¨${(m.g*3600).toFixed(4)}/h</small></div>
                    </div>
                    <button class="buy-btn" onclick="buy(${i})">‚Ç¨${m.p}</button>
                </div>
            `).join('');
        }

        function buy(i) {
            if(u.bal >= miners[i].p) {
                u.bal -= miners[i].p; u.pps += miners[i].g; u.inv[i] = (u.inv[i]||0)+1;
                renderShop(); up(); tg.HapticFeedback.notificationOccurred('success');
            } else tg.HapticFeedback.notificationOccurred('error');
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        
        function sw(t) {
            document.querySelectorAll('.tab').forEach(e=>e.style.display='none');
            document.getElementById('tab-'+t).style.display='block';
            document.querySelectorAll('.n-btn').forEach(b=>b.classList.remove('active'));
            document.getElementById('nb-'+t).classList.add('active');
        }

        function copyLink() { navigator.clipboard.writeText(document.getElementById('my-link').innerText); tg.showAlert("Copied!"); }

        setInterval(() => { if(loaded) { u.bal += u.pps; if(u.eng<500) u.eng+=0.5; up(); } }, 1000);
        setInterval(() => { if(loaded && uid) { u.lastT = Date.now(); db.ref('users/'+uid).update(u); } }, 5000);

    </script>
</body>
</html>
