<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EURODASH OFFICIAL</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        body { background-color: #050505; color: #fff; font-family: 'Rajdhani', sans-serif; margin: 0; text-align: center; overflow: hidden; user-select: none; -webkit-tap-highlight-color: transparent; }
        #matrix-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; transition: 1s; }

        .ticker-wrap { position: fixed; top: 40px; left: 0; width: 100%; background: rgba(0,0,0,0.8); overflow: hidden; height: 25px; line-height: 25px; z-index: 40; border-bottom: 1px solid #333; }
        .ticker { display: inline-block; white-space: nowrap; padding-left: 100%; animation: ticker 30s linear infinite; color: #0f9; font-size: 12px; font-weight: bold; }
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        /* SCROLL FIXO */
        .tab { display: none; position: fixed; top: 70px; left: 0; right: 0; bottom: 80px; padding: 20px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        
        .buy-btn { background: #0f9; color: #000; border: none; padding: 8px 20px; border-radius: 4px; font-weight: bold; font-family: 'Rajdhani'; cursor: pointer; text-transform: uppercase; font-size: 14px; box-shadow: 0 0 10px rgba(0,255,153,0.2); transition: 0.2s; position: relative; overflow: hidden; }
        .buy-btn:active { transform: scale(0.95); }
        .w-btn { background: #ff3333; color: #fff; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px rgba(255,0,0,0.3); }
        .dep-btn { background: #00ccff; color: #000; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px rgba(0,204,255,0.3); }
        .set-btn { background: #333; color: #fff; border: 1px solid #555; padding: 10px; width: 100%; margin-bottom: 8px; border-radius: 5px; text-align: left; cursor: pointer; font-family: 'Rajdhani'; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }

        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index: 200; align-items:center; justify-content:center; flex-direction:column; backdrop-filter: blur(5px); }
        .modal-box { background: #111; border: 1px solid #0f9; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 0 30px rgba(0,255,153,0.1); width: 85%; max-width: 350px; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; color: #555; font-size: 24px; cursor: pointer; }
        .inp { width: 90%; background: #000; border: 1px solid #333; color: #fff; padding: 10px; margin: 10px 0; border-radius: 5px; font-family: monospace; text-align: center; }
        .inp:focus { border-color: #0f9; outline: none; }

        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: 'VT323', monospace; }
        .boot-text { color: #0f9; font-size: 16px; width: 80%; text-align: left; margin-bottom: 5px; text-shadow: 0 0 5px #0f9; }
        .glitch { font-size: 50px; font-weight: bold; color: #fff; text-shadow: 2px 2px #0f9; animation: glitch 1s infinite; letter-spacing: 5px; margin-bottom: 20px; font-family: 'Rajdhani'; }
        @keyframes glitch { 0% { transform: translate(0); } 20% { transform: translate(-2px, 2px); } 40% { transform: translate(-2px, -2px); } 60% { transform: translate(2px, 2px); } 80% { transform: translate(2px, -2px); } 100% { transform: translate(0); } }

        .main-img-con { position: relative; width: 220px; height: 220px; margin: 0 auto; display: flex; align-items: center; justify-content: center; }
        .main-img { width: 100%; height: 100%; border-radius: 50%; border: 2px solid rgba(0,255,153,0.3); box-shadow: 0 0 30px rgba(0,255,153,0.2); cursor: pointer; z-index: 10; -webkit-user-drag: none; transition: transform 0.1s; }
        .main-img.click-anim { animation: pulseWave 0.15s ease-out; }
        @keyframes pulseWave { 0% { transform: scale(0.96); border-color:#fff; } 100% { transform: scale(1); border-color:rgba(0,255,153,0.3); } }

        .float-text { position: absolute; color: #fff; font-weight: bold; font-size: 24px; pointer-events: none; animation: floatUp 0.8s ease-out forwards; text-shadow: 0 0 5px #0f9; z-index: 20; }
        .crit { color: #ffd700 !important; font-size: 32px !important; text-shadow: 0 0 15px #ffaa00 !important; z-index: 25; }
        .lucky { color: #00ccff !important; font-size: 28px !important; text-shadow: 0 0 15px #00ccff !important; z-index: 30; }
        @keyframes floatUp { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), -100px) scale(1.2); opacity: 0; } }

        .eng-bar-bg { width: 200px; height: 10px; background: #222; margin: 5px auto; border-radius: 5px; overflow: hidden; border: 1px solid #333; position: relative; }
        .eng-bar-fill { height: 100%; background: #0f9; width: 100%; box-shadow: 0 0 10px #0f9; transition: width 0.2s; }
        .boost-btn { position: absolute; right: -35px; top: -8px; background: #ffd700; color: #000; border-radius: 50%; width: 26px; height: 26px; font-size: 14px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; border: 2px solid #fff; box-shadow: 0 0 10px #ffd700; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        .lvl-con { width: 60%; margin: 0 auto 5px auto; background: #111; height: 6px; border-radius: 3px; position: relative; border: 1px solid #333; display: inline-block; vertical-align: middle; }
        .lvl-fill { height: 100%; background: linear-gradient(90deg, #0f9, #00ffff); width: 0%; border-radius: 3px; transition: width 0.5s; box-shadow: 0 0 10px #0f9; }
        .info-btn { background: #333; color: #fff; border: 1px solid #555; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; cursor: pointer; margin-left: 5px; display: inline-flex; align-items: center; justify-content: center; }

        .card { background: rgba(10,10,10,0.8); border: 1px solid #222; border-left: 3px solid #0f9; border-radius: 10px; padding: 15px; margin-bottom: 12px; text-align: left; display: flex; align-items: center; justify-content: space-between; backdrop-filter: blur(5px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); position: relative; }
        .market-header { background: #111; padding: 15px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        
        .rank-row { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #222; }
        .rank-img { width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; border: 1px solid #0f9; background: #333; }
        
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; background: rgba(5,5,5,0.95); border-top: 1px solid #222; padding-bottom: 20px; padding-top: 10px; z-index: 100; backdrop-filter: blur(10px); }
        .n-btn { flex: 1; color: #444; font-size: 10px; font-weight: bold; display: flex; flex-direction: column; align-items: center; gap: 5px; text-transform: uppercase; letter-spacing: 1px; position: relative; }
        .n-btn.active { color: #0f9; text-shadow: 0 0 10px rgba(0,255,153,0.6); }
        .n-icon { font-size: 22px; margin-bottom: 2px; }
        
        .badge { position: absolute; top: 0; right: 25%; width: 8px; height: 8px; background: red; border-radius: 50%; border: 1px solid #fff; display: none; box-shadow: 0 0 5px red; }

        #force-btn { display:none; margin-top:20px; padding:10px 20px; background:red; color:#fff; border:none; border-radius:5px; font-weight:bold; cursor:pointer; font-size:12px; z-index:99999; }
        
        .lang-bar { position: absolute; top: 10px; right: 10px; z-index: 50; display: flex; gap: 5px; }
        .l-btn { background: rgba(0,0,0,0.6); color: #888; border: 1px solid #333; padding: 3px 8px; border-radius: 5px; font-size: 10px; cursor: pointer; font-weight: bold; }
        .l-btn.active { color: #0f9; border-color: #0f9; box-shadow: 0 0 5px rgba(0,255,153,0.3); }

        .settings-icon { position: absolute; top: 10px; left: 10px; z-index: 50; background: rgba(0,0,0,0.6); border: 1px solid #333; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 18px; }
        
        .trophy-icon { position: absolute; top: 10px; left: 50px; z-index: 50; background: rgba(0,0,0,0.6); border: 1px solid #ffd700; color: #ffd700; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 16px; }

        .online-cnt { position: absolute; top: 45px; left: 10px; z-index: 50; font-size: 10px; color: #0f9; background: rgba(0,0,0,0.7); padding: 2px 6px; border-radius: 4px; border: 1px solid #333; }

        .day-grid { display: flex; gap: 5px; justify-content: center; margin-top: 10px; }
        .day-box { background: #222; border: 1px solid #333; padding: 5px; width: 30px; font-size: 10px; opacity: 0.5; border-radius: 4px; }
        .day-box.active { border-color: #0f9; opacity: 1; box-shadow: 0 0 5px #0f9; background: rgba(0,255,153,0.1); }

        .admin-row { background: #222; padding: 10px; margin-bottom: 5px; border-left: 3px solid orange; text-align: left; font-size: 12px; }
        .admin-actions { display: flex; gap: 5px; margin-top: 5px; }
        .a-btn { padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer; font-weight: bold; flex: 1; }
        .a-check { background: #00ccff; color: #000; }
        .a-approve { background: #0f9; color: #000; }
        .a-reject { background: #f00; color: #fff; }
        
        .game-box { background:#111; border:1px solid #333; border-radius:10px; padding:20px; margin-bottom:10px; text-align:center; position:relative; overflow:hidden;}
        .game-res { font-size:32px; font-weight:bold; margin:10px 0; color:#fff; min-height:40px; }
        .win { color:#0f9; text-shadow:0 0 20px #0f9; }
        .lose { color:#f00; text-shadow:0 0 20px #f00; }
        .coin-anim { animation: spin 1s infinite linear; }
        @keyframes spin { 0% { transform: rotateY(0); } 100% { transform: rotateY(360deg); } }
        
        .fallback-icon { font-size:30px; display:flex; align-items:center; justify-content:center; width:50px; height:50px; background:#222; border-radius:5px; border:1px solid #333; color: #fff; flex-shrink: 0; }
        
        #debug-box { display:none; }
        .spacer { height: 250px; width: 100%; text-align:center; padding-top:20px; color:#333; font-size:10px; }

        /* === JUICE EFFECTS === */
        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
          10%, 90% { transform: translate3d(-1px, 0, 0); }
          20%, 80% { transform: translate3d(2px, 0, 0); }
          30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
          40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .turbo-con { width: 80%; margin: 10px auto; background: #111; height: 15px; border-radius: 10px; border: 1px solid #333; position: relative; overflow: hidden; }
        .turbo-fill { height: 100%; background: linear-gradient(90deg, #ff0000, #ffff00); width: 0%; transition: width 0.1s linear; }
        .turbo-text { position: absolute; width: 100%; top: 0; left: 0; line-height: 15px; font-size: 10px; color: #000; font-weight: bold; display: none; }
        .active-turbo .turbo-fill { width: 100% !important; animation: drain 10s linear forwards; }
        @keyframes drain { from { width: 100%; } to { width: 0%; } }

        .particle { position: absolute; pointer-events: none; width: 6px; height: 6px; border-radius: 50%; background: #0f9; box-shadow: 0 0 5px #0f9; animation: pop 0.6s ease-out forwards; z-index: 99; }
        @keyframes pop { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; } }

        .golden-euro { position: fixed; width: 60px; height: 60px; z-index: 200; font-size: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; animation: floatMove 8s linear forwards; user-select: none; }
        @keyframes floatMove { 0% { left: -100px; transform: rotate(0deg); } 100% { left: 110%; transform: rotate(360deg); } }

        .badge-tag { position: absolute; top: -10px; right: -5px; padding: 2px 6px; border-radius: 4px; font-size: 9px; font-weight: bold; text-transform: uppercase; animation: pulseTag 2s infinite; color: #000; box-shadow: 0 0 5px currentColor; }
        .tag-best { background: #ffd700; color: #000; }
        .tag-hot { background: #ff3333; color: #fff; }
        @keyframes pulseTag { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* === NEW WHEEL & SHOP UI === */
        #toast-box { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); z-index: 10000; width: 90%; pointer-events: none; display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .toast { background: rgba(10,10,10,0.95); border: 1px solid #0f9; color: #fff; padding: 12px 20px; border-radius: 8px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.8); animation: slideDown 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); font-size: 13px; font-weight: bold; width: fit-content; max-width: 90%; backdrop-filter: blur(5px); }
        .toast.error { border-color: #ff3333; color: #ffcccc; box-shadow: 0 5px 20px rgba(255,0,0,0.2); }
        @keyframes slideDown { from { transform: translateY(-50px) scale(0.8); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; transform: translateY(-10px); } }

        .wheel-con { position: relative; width: 220px; height: 220px; margin: 20px auto; }
        .wheel { width: 100%; height: 100%; border-radius: 50%; border: 5px solid #fff; box-sizing: border-box; background: conic-gradient(#f00 0deg 60deg, #ff8c00 60deg 120deg, #ffd700 120deg 180deg, #0f9 180deg 240deg, #00bfff 240deg 300deg, #9400d3 300deg 360deg); transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1); box-shadow: 0 0 20px rgba(255,255,255,0.2); position: relative; }
        .wheel-pointer { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 20px solid #fff; z-index: 10; filter: drop-shadow(0 0 5px #000); }
        .spin-btn { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60px; height: 60px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; cursor: pointer; border: 4px solid #000; box-shadow: 0 0 15px rgba(255,255,255,0.5); font-size: 12px; z-index: 5; }
        
        .wheel-icon { position: absolute; top: 50%; left: 50%; font-size: 24px; transform-origin: 0 0; }
        .wi-1 { transform: rotate(30deg) translate(0, -70px) rotate(-30deg) translate(-50%, -50%); } 
        .wi-2 { transform: rotate(90deg) translate(0, -70px) rotate(-90deg) translate(-50%, -50%); } 
        .wi-3 { transform: rotate(150deg) translate(0, -70px) rotate(-150deg) translate(-50%, -50%); } 
        .wi-4 { transform: rotate(210deg) translate(0, -70px) rotate(-210deg) translate(-50%, -50%); } 
        .wi-5 { transform: rotate(270deg) translate(0, -70px) rotate(-270deg) translate(-50%, -50%); } 
        .wi-6 { transform: rotate(330deg) translate(0, -70px) rotate(-330deg) translate(-50%, -50%); } 

        .shop-nav { display: flex; margin-bottom: 15px; gap: 10px; }
        .shop-tab { flex: 1; padding: 10px; background: #222; border: 1px solid #333; border-radius: 5px; color: #888; font-weight: bold; cursor: pointer; }
        .shop-tab.active { background: #0f9; color: #000; border-color: #0f9; }

        /* === ACHIEVEMENTS & LEVEL UP === */
        .ach-row { display: flex; align-items: center; background: #222; border: 1px solid #333; padding: 10px; border-radius: 8px; margin-bottom: 8px; text-align: left; opacity: 0.5; filter: grayscale(1); transition: 0.3s; }
        .ach-row.unlocked { opacity: 1; filter: grayscale(0); border-color: #ffd700; box-shadow: 0 0 10px rgba(255,215,0,0.1); }
        .ach-icon { font-size: 24px; margin-right: 10px; }
        .ach-info { flex-grow: 1; }
        
        #levelup-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 500; align-items: center; justify-content: center; flex-direction: column; }
        .levelup-title { font-size: 40px; color: #ffd700; font-weight: bold; animation: pulse 1s infinite; text-shadow: 0 0 20px #ffd700; }
        .levelup-rank { font-size: 24px; color: #fff; margin-top: 10px; letter-spacing: 5px; }
        .confetti { position: absolute; width: 10px; height: 10px; background: #ffd700; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }
    </style>
</head>
<body>
    <canvas id="matrix-bg"></canvas>
    <div id="toast-box"></div>

    <div id="levelup-overlay" onclick="this.style.display='none'">
        <div class="levelup-title">LEVEL UP!</div>
        <div class="levelup-rank" id="new-rank-name">HACKER</div>
        <div style="margin-top:20px; font-size:12px; color:#aaa;">Tap to continue</div>
    </div>

    <div class="ticker-wrap">
        <div class="ticker" id="news-ticker">üöÄ WELCOME TO EURODASH --- SYSTEM ONLINE --- JOIN THE REVOLUTION</div>
    </div>

    <div class="settings-icon" onclick="openModal('modal-settings')">‚öôÔ∏è</div>
    <div class="trophy-icon" onclick="openModal('modal-achievements')">üèÜ</div>
    
    <div class="online-cnt" id="online-users">üü¢ 1 Online</div>

    <div class="lang-bar">
        <div class="l-btn active" id="btn-en" onclick="setLang('en')">EN</div>
        <div class="l-btn" id="btn-pt" onclick="setLang('pt')">PT</div>
        <div class="l-btn" id="btn-ru" onclick="setLang('ru')">RU</div>
        <div class="l-btn" id="btn-admin" style="display:none; border-color: orange; color: orange;" onclick="sw('admin')">ADMIN</div>
    </div>

    <div id="loader">
        <div class="glitch">EURODASH</div>
        <div id="boot-seq" style="width: 100%; display: flex; flex-direction: column; align-items: center;"></div>
        <div id="debug-box"></div>
        <button id="force-btn" onclick="finishLoad()">‚ö†Ô∏è FORCE START</button>
    </div>

    <div id="modal-settings" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-settings')">&times;</span>
            <h2 style="color:#fff; margin-bottom:20px;">SETTINGS</h2>
            <button class="set-btn" onclick="toggleSound()"><span>Sound Effects</span> <span id="snd-stat">ON üîä</span></button>
            <button class="set-btn" onclick="closeModal('modal-settings'); openModal('modal-tutorial');"><span>Replay Tutorial</span> <span>üéì</span></button>
            <button class="set-btn" onclick="openSupport()"><span>Support</span> <span>üìû</span></button>
            <button class="set-btn" onclick="openChannel()"><span>Official Channel</span> <span>üì¢</span></button>
            <p style="color:#555; font-size:10px; margin-top:20px;">UID: <span id="disp-uid">...</span></p>
        </div>
    </div>

    <div id="modal-achievements" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-achievements')">&times;</span>
            <h2 style="color:#ffd700; margin-bottom:20px;">ACHIEVEMENTS</h2>
            <div id="ach-list" style="max-height: 300px; overflow-y: auto;"></div>
        </div>
    </div>

    <div id="modal-tutorial" class="modal">
        <div class="modal-box">
            <h2 style="color:#0f9">WELCOME, MINER!</h2>
            <div style="text-align:left; font-size:14px; margin:20px 0; color:#ddd;">
                1. üëÜ <b>TAP</b> to generate Energy.<br><br>
                2. üõçÔ∏è <b>BUY</b> Miners in the Shop to earn money while you sleep.<br><br>
                3. üé≤ <b>PLAY</b> Games to double your cash.<br><br>
                4. üí∞ <b>WITHDRAW</b> real money via TRC20.<br><br>
                <div style="background:#222; border:1px solid #0f9; padding:10px; border-radius:5px; text-align:center;">
                    <b style="color:#0f9">GIFT:</b> You received 1x Free CPU Miner!
                </div>
            </div>
            <button class="buy-btn" style="width:100%" onclick="closeModal('modal-tutorial')">LET'S GO!</button>
        </div>
    </div>

    <div id="modal-daily" class="modal">
        <div class="modal-box">
            <h2 style="color:#ffd700;">DAILY STREAK üî•</h2>
            <p style="color:#aaa; font-size:12px;">Come back every day to earn more!</p>
            <div class="day-grid">
                <div class="day-box" id="day-1">1<br>‚Ç¨0.01</div>
                <div class="day-box" id="day-2">2<br>‚Ç¨0.03</div>
                <div class="day-box" id="day-3">3<br>‚Ç¨0.05</div>
                <div class="day-box" id="day-4">4<br>‚Ç¨0.08</div>
                <div class="day-box" id="day-5">5<br>‚Ç¨0.12</div>
                <div class="day-box" id="day-6">6<br>‚Ç¨0.20</div>
                <div class="day-box" id="day-7" style="color:#ffd700">7<br>‚Ç¨0.50</div>
            </div>
            <h1 style="color:#0f9; margin:15px 0;">+‚Ç¨<span id="daily-amt">0.00</span></h1>
            <button class="buy-btn" onclick="claimDaily()" id="btn-claim-daily">CLAIM REWARD</button>
        </div>
    </div>

    <div id="modal-refill" class="modal">
        <div class="modal-box">
            <h2 style="color:#0f9">‚ö° ENERGY BOOST</h2>
            <p style="color:#aaa;">Refill Energy instantly?</p>
            <h1 style="color:#fff;">Price: <span style="color:#ffd700">‚Ç¨0.05</span></h1>
            <button class="buy-btn" onclick="buyRefill()">BUY REFILL</button>
            <br><br>
            <button class="buy-btn" style="background:#333; color:#fff" onclick="closeModal('modal-refill')">CANCEL</button>
        </div>
    </div>

    <div id="modal-offline" class="modal">
        <div class="modal-box">
            <h2 style="color:#fff;" id="t-welcome">WELCOME BACK</h2>
            <p style="color:#aaa;" id="t-off-earn">Offline Earnings:</p>
            <h1 style="color:#0f9; font-size:40px;">+‚Ç¨<span id="off-val">0.00</span></h1>
            <p style="color:#555; font-size:10px;">(Max offline time: 3 Hours)</p>
            <button class="buy-btn" onclick="closeModal('modal-offline')" id="t-collect">COLLECT</button>
        </div>
    </div>

    <div id="modal-levels" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-levels')">&times;</span>
            <h3 style="color:#0f9" id="t-lvl-sys">LEVEL SYSTEM</h3>
            <div style="text-align:left; font-size:14px; color:#ddd; line-height:1.6;">
                <b style="color:#fff">1. NOOB (‚Ç¨0-10)</b><br>Basic mining speed.<br><br>
                <b style="color:#00ffff">2. HACKER (‚Ç¨10-50)</b><br>+2% Critical Chance.<br><br>
                <b style="color:#ff00ff">3. CYBER LORD (‚Ç¨50-200)</b><br>+5% Critical Chance.<br><br>
                <b style="color:#ffd700">4. TITAN (‚Ç¨200+)</b><br>+10% Critical Chance + Max Energy.
            </div>
        </div>
    </div>

    <div id="modal-withdraw" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-withdraw')">&times;</span>
            <h3 style="color:#ff3333" id="t-wd-tit">WITHDRAW (TRC20)</h3>
            <p style="font-size:12px; color:#888;" id="t-wd-info">Min: ‚Ç¨1.00 | Fee: 2%</p>
            
            <div style="text-align:right; margin-bottom:5px; font-size:12px;">
                <span style="color:#888" id="t-avail">Available:</span> <span style="color:#fff">‚Ç¨<span id="wd-avail">0.00</span></span>
                <span style="color:#0f9; cursor:pointer; margin-left:8px; font-weight:bold; border:1px solid #0f9; padding:0 4px; border-radius:3px;" onclick="setMax()">MAX</span>
            </div>

            <input type="text" id="wd-addr" class="inp" placeholder="Paste TRC20 Address">
            <input type="number" id="wd-amount" class="inp" placeholder="Amount (‚Ç¨)" oninput="calcFee()">
            
            <div style="font-size:13px; margin:10px 0; background:#222; padding:10px; border-radius:5px;">
                <span id="t-receive">You Receive:</span> <b style="color:#fff; font-size:16px;">‚Ç¨<span id="wd-final">0.00</span></b>
                <div style="color:#555; font-size:10px;" id="t-fee-inc">(Fees included)</div>
            </div>
            <div style="margin-bottom:10px; font-size:11px; text-align:left; color:#aaa; max-height:60px; overflow-y:auto;" id="wd-history"></div>
            <button class="w-btn" onclick="submitWithdraw()" id="t-confirm">CONFIRM</button>
        </div>
    </div>

    <div id="modal-deposit" class="modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeModal('modal-deposit')">&times;</span>
            <h3 style="color:#00ccff">DEPOSIT (USDT)</h3>
            
            <p style="font-size:12px; color:#aaa; margin-bottom: 5px;">1. Send USDT (TRC20) to:</p>
            
            <div style="background:#fff; padding:5px; display:inline-block; border-radius:10px; margin-bottom:10px;">
                <img id="qr-code" src="" width="120" height="120" onerror="this.style.display='none'" style="display:block;">
            </div>

            <div onclick="copyWallet()" style="background:#222; padding:10px; border-radius:8px; border:1px dashed #0f9; cursor:pointer;">
                <p style="font-size:9px; color:#888; margin:0;">TAP TO COPY:</p>
                <div style="font-size:10px; color:#fff; word-break:break-all; font-family:monospace; font-weight:bold;" id="admin-wallet">...</div>
            </div>

            <hr style="border-color:#333; margin:15px 0;">

            <p style="font-size:12px; color:#aaa; margin-bottom: 10px;">2. Send proof to Admin:</p>

            <button class="buy-btn" onclick="sendProof()" style="width:100%; padding:15px; font-size:14px; display:flex; align-items:center; justify-content:center; gap:10px;">
                üì∏ SEND PROOF
            </button>
            
            <p style="font-size:9px; color:#555; margin-top:10px;">
                Your ID: <span id="proof-uid" style="color:#0f9">...</span>
            </p>
        </div>
    </div>

    <div id="tab-core" class="tab" style="display:block;">
        <div id="balance" style="font-size:52px; font-weight:700; margin-top:20px;">‚Ç¨<span id="bal-val">0.00000</span></div>
        
        <div class="turbo-con" id="turbo-box">
            <div class="turbo-fill" id="turbo-bar"></div>
            <div class="turbo-text" id="turbo-msg">üî• OVERCLOCK ACTIVE (2X) üî•</div>
        </div>

        <div style="margin-bottom:20px;">
            <div class="lvl-con"><div class="lvl-fill" id="l-fill"></div></div>
            <button class="info-btn" onclick="openModal('modal-levels')">?</button>
            <div style="font-size:12px; color:#aaa; letter-spacing:2px;" id="l-name">NOOB</div>
        </div>
        <div class="main-img-con">
            <img src="image_3.jpg" class="main-img" id="click-btn" onerror="this.src='https://via.placeholder.com/220/000/0f9?text=TAP'">
        </div>
        <div style="margin-top:20px; display:flex; justify-content:center; gap:30px;">
            <div>
                <b style="color:#0f9; font-size:20px;">‚ö° <span id="eg">500</span></b>
                <div class="eng-bar-bg">
                    <div class="eng-bar-fill" id="eng-bar"></div>
                    <div class="boost-btn" onclick="openModal('modal-refill')">+</div>
                </div>
                <small style="color:#555" id="t-energy">ENERGY</small>
            </div>
            <div style="margin-top:5px;">
                <b style="color:#0f9; font-size:20px;">üöÄ <span id="pps-disp">0</span></b><br>
                <small style="color:#555" id="t-pps">PROFIT/SEC</small>
            </div>
        </div>
    </div>

    <div id="tab-shop" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-market">MARKET</h2>
        <div class="market-header">
            <div style="text-align:left;">
                <span style="font-size:12px; color:#888;" id="t-wallet">WALLET</span><br>
                <b style="font-size:18px;">‚Ç¨<span id="bal-shop">0.00</span></b>
            </div>
            <div style="display:flex; gap:5px;">
                <button class="dep-btn" onclick="openModal('modal-deposit')" id="t-btn-dep">DEP</button>
                <button class="w-btn" onclick="openModal('modal-withdraw')" id="t-btn-wd">W/D</button>
            </div>
        </div>
        
        <div class="shop-nav">
            <div class="shop-tab active" id="st-miners" onclick="toggleShop('miners')">MINERS üíª</div>
            <div class="shop-tab" id="st-boosters" onclick="toggleShop('boosters')">BOOSTERS üöÄ</div>
        </div>

        <div id="shop-list"></div>
    </div>

    <div id="tab-games" class="tab">
        <div class="game-box" style="border:1px solid #ff00ff; box-shadow: 0 0 10px rgba(255,0,255,0.2);">
            <h3 style="color:#ff00ff; margin:0;">LUCKY WHEEL üé°</h3>
            <p style="color:#aaa; font-size:12px;">1 Free Spin / Day (or ‚Ç¨0.20)</p>
            
            <div class="wheel-con">
                <div class="wheel-pointer"></div>
                <div class="wheel" id="lucky-wheel">
                    <div class="wheel-icon wi-1">üò¢</div>
                    <div class="wheel-icon wi-2">üí∞</div>
                    <div class="wheel-icon wi-3">‚ö°</div>
                    <div class="wheel-icon wi-4">üíé</div>
                    <div class="wheel-icon wi-5">üò¢</div>
                    <div class="wheel-icon wi-6">ü§ë</div>
                </div>
                <div class="spin-btn" onclick="spinWheel()">SPIN</div>
            </div>
            
            <div style="font-size:10px; color:#555;">Win up to ‚Ç¨1.00 or Energy!</div>
        </div>

        <div class="game-box">
            <h3 style="color:#0f9; margin:0;">CYBER DICE üé≤</h3>
            <p style="color:#aaa; font-size:12px;">Roll > 55 to Win 2x</p>
            <div class="game-res" id="dice-result">?</div>
            <input type="number" id="dice-bet" class="inp" placeholder="Bet (‚Ç¨)" style="width:50%;">
            <br>
            <button class="buy-btn" style="margin-top:10px; width:60%;" onclick="rollDice()">ROLL</button>
        </div>
        <div class="game-box" style="border-left:3px solid #ffd700;">
            <h3 style="color:#ffd700; margin:0;">COIN FLIP ü™ô</h3>
            <p style="color:#aaa; font-size:12px;">Heads or Tails (2x)</p>
            <div class="game-res" id="coin-result">üü°</div>
            <input type="number" id="coin-bet" class="inp" placeholder="Bet (‚Ç¨)" style="width:50%;">
            <div style="margin-top:10px;">
                <button class="buy-btn" style="background:#444; color:#fff;" onclick="flipCoin('heads')">HEADS</button>
                <button class="buy-btn" style="background:#ffd700; color:#000;" onclick="flipCoin('tails')">TAILS</button>
            </div>
        </div>
    </div>

    <div id="tab-friends" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-net-tit">NETWORK</h2>
        <div class="card" style="display:block; text-align:center;">
            <h1>üíé</h1>
            <p style="color:#aaa;" id="t-inv-desc">Invite friends & earn 5% of their mining!</p>
            <div style="background:#000; padding:10px; color:#0f9; font-size:12px; border:1px dashed #333; margin-bottom:10px; word-break:break-all;" id="my-link">...</div>
            <button onclick="copyLink()" class="buy-btn" style="width:100%" id="t-copy-link">COPY LINK</button>
        </div>
    </div>

    <div id="tab-earn" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-task-tit">TASKS</h2>
        <div class="card">
            <div><b style="color:#fff" id="t-join-ch">Join Official Channel</b><br><small style="color:#0f9" id="t-rew">+‚Ç¨0.10 Reward</small></div>
            <button class="buy-btn" id="task-group" onclick="doTask('group', 0.10)">START</button>
        </div>
        <div class="card" style="display:block;">
            <b style="color:#fff" id="t-promo-tit">SECRET CODE</b><br>
            <input type="text" id="promo-in" class="inp" placeholder="Enter Code" style="margin-bottom:5px;">
            <button class="buy-btn" style="width:100%" onclick="redeemCode()" id="t-redeem">REDEEM</button>
        </div>
    </div>

    <div id="tab-rank" class="tab">
        <h2 style="color:#0f9; border-bottom:1px solid #333;" id="t-rank-tit">TOP INVESTORS</h2>
        <div style="background:#111; border-radius:10px; padding:10px; border:1px solid #333;" id="rank-list">
            <div style="padding:20px; color:#555;" id="t-load-rank">Loading real data...</div>
        </div>
    </div>

    <div id="tab-admin" class="tab">
        <h2 style="color:orange; border-bottom:1px solid orange;">ADMIN PANEL üëÆ‚Äç‚ôÇÔ∏è</h2>
        <p style="font-size:12px; color:#888;">Pending Deposits</p>
        <div id="admin-list" style="margin-top:10px; max-height:80vh; overflow-y:auto;"></div>
    </div>

    <div class="nav">
        <div class="n-btn active" id="nb-core" onclick="sw('core')">
            <span class="n-icon">‚ö°</span><span id="n-mine">MINE</span>
        </div>
        <div class="n-btn" id="nb-shop" onclick="sw('shop')">
            <span class="n-icon">üõçÔ∏è</span><span id="n-shop">SHOP</span>
            <div class="badge" id="badge-shop"></div>
        </div>
        <div class="n-btn" id="nb-games" onclick="sw('games')">
            <span class="n-icon">üé≤</span><span id="n-games">GAMES</span>
            <div class="badge" id="badge-games"></div>
        </div>
        <div class="n-btn" id="nb-friends" onclick="sw('friends')">
            <span class="n-icon">üë•</span><span id="n-team">TEAM</span>
        </div>
        <div class="n-btn" id="nb-rank" onclick="sw('rank')">
            <span class="n-icon">üèÜ</span><span id="n-rank">RANK</span>
        </div>
    </div>

    <script>
        // GLOBAL ERROR HANDLER
        window.onerror = function(msg, url, line) {
            let logBox = document.getElementById('debug-box');
            if(logBox) {
                logBox.style.display = 'block';
                logBox.innerHTML += `<div style="color:red; border-bottom:1px solid #333;">ERROR: ${msg} (Line ${line})</div>`;
            }
            if(document.getElementById('force-btn')) document.getElementById('force-btn').style.display = 'block';
            return false;
        };

        function log(msg) {
            let logBox = document.getElementById('debug-box');
            if(logBox) logBox.innerHTML += `<div>>> ${msg}</div>`;
        }

        // MATRIX BACKGROUND (DYNAMIC COLOR)
        const canvas = document.getElementById('matrix-bg');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        const fontSize = 14;
        const columns = canvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);
        let matrixColor = '#0f9'; // Default Green

        function drawMatrix() {
            ctx.fillStyle = 'rgba(5, 5, 5, 0.1)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = matrixColor; ctx.font = fontSize + 'px monospace';
            for (let i = 0; i < drops.length; i++) {
                const text = chars[Math.floor(Math.random() * chars.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
        }
        setInterval(drawMatrix, 50);
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

        // SOUND SYSTEM
        let soundEnabled = true;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function toggleSound() { 
            soundEnabled = !soundEnabled; 
            document.getElementById('snd-stat').innerText = soundEnabled ? 'ON üîä' : 'OFF üîá';
        }
        function playBeep() {
            if(!soundEnabled) return;
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(300, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        // CONFIG & DATA
        const CONFIG = { telegram_link: "https://t.me/EuroDashOfficial", admin_wallet: "TWk7a3xLdEX3XWRGWaBHT1mbc8kq3JYZJw", min_withdraw: 1.00, fee: 0.02 };
        const PROMO_CODES = { "EUROSTART": 0.50, "VIKTORLAUNCH": 1.00, "HACKERBONUS": 0.25 };
        const DAILY_REWARDS = [0.01, 0.03, 0.05, 0.08, 0.12, 0.20, 0.50];
        const ADMIN_ID = 253106429; 
        const MINER_EMOJIS = ["üíª", "üñ•Ô∏è", "‚ö°", "üîã", "‚ò¢Ô∏è", "üåå"]; 
        const MAX_OFFLINE_SEC = 3 * 3600; // 3 Horas de limite offline

        let CUR_LANG = 'en';
        const txt = {
            en: {
                welcome: "WELCOME BACK", off_earn: "Offline Earnings:", collect: "COLLECT",
                lvl_sys: "LEVEL SYSTEM", wd_tit: "WITHDRAW (TRC20)", wd_info: "Min: ‚Ç¨1.00 | Fee: 2%",
                avail: "Available:", receive: "You Receive:", fee_inc: "(Fees included)", confirm: "CONFIRM",
                energy: "ENERGY", pps: "PROFIT/SEC", market: "MARKET", wallet: "WALLET",
                rank_tit: "TOP INVESTORS", load_rank: "Loading real data...", rank_off: "Offline (DB Error)", net_tit: "NETWORK",
                inv_desc: "Invite friends & earn 5% of their mining!", copy_link: "COPY LINK",
                task_tit: "TASKS", join_ch: "Join Official Channel", rew: "+‚Ç¨0.10 Reward",
                promo_tit: "SECRET CODE", redeem: "REDEEM", force_play: "‚ö†Ô∏è PLAY OFFLINE", db_slow: "Connecting...", db_err: "Error: ",
                nav: ["MINE", "SHOP", "GAMES", "TEAM", "RANK"],
                miners: ["Micro Node", "Blade Rack", "Turbo Server", "Cyber Station", "Quantum Rig", "Neural Hub"],
                alerts: {
                    copied: "Address Copied!", invalid_trc20: "Invalid TRC20 Address!", min_wd: "Min withdraw is ‚Ç¨",
                    insufficient: "‚ùå Insufficient Balance! You only have ‚Ç¨", req_sent: "Request Sent!",
                    inv_hash: "Invalid Hash", dep_sub: "Deposit Submitted!", rew_rec: "Received!",
                    code_inv: "Invalid Code!", code_used: "Code already used!", code_ok: "Code Redeemed!", daily: "Day"
                }
            },
            pt: {
                welcome: "BEM-VINDO DE VOLTA", off_earn: "Ganhos Offline:", collect: "RECEBER",
                lvl_sys: "SISTEMA DE N√çVEIS", wd_tit: "LEVANTAR (TRC20)", wd_info: "Min: ‚Ç¨1.00 | Taxa: 2%",
                avail: "Dispon√≠vel:", receive: "Recebes:", fee_inc: "(Taxas inclu√≠das)", confirm: "CONFIRMAR",
                energy: "ENERGIA", pps: "LUCRO/SEG", market: "MERCADO", wallet: "CARTEIRA",
                rank_tit: "TOP INVESTIDORES", load_rank: "A carregar dados...", rank_off: "Offline (Erro DB)", net_tit: "REDE",
                inv_desc: "Convida amigos e ganha 5% do que minerarem!", copy_link: "COPIAR LINK",
                task_tit: "TAREFAS", join_ch: "Entrar no Canal Oficial", rew: "+‚Ç¨0.10 Recompensa",
                promo_tit: "C√ìDIGO SECRETO", redeem: "RESGATAR", force_play: "‚ö†Ô∏è JOGAR OFFLINE", db_slow: "A ligar...", db_err: "Erro: ",
                nav: ["MINAR", "LOJA", "JOGOS", "EQUIPA", "RANK"],
                miners: ["Micro N√≥", "Rack Blade", "Servidor Turbo", "Esta√ß√£o Cyber", "Rig Qu√¢ntico", "Hub Neural"],
                alerts: {
                    copied: "Copiado!", invalid_trc20: "Endere√ßo TRC20 Inv√°lido!", min_wd: "M√≠nimo de levantamento √© ‚Ç¨",
                    insufficient: "‚ùå Saldo Insuficiente! Tens apenas ‚Ç¨", req_sent: "Pedido Enviado!",
                    inv_hash: "Hash Inv√°lido", dep_sub: "Dep√≥sito Enviado!", rew_rec: "Recebido!",
                    code_inv: "C√≥digo Inv√°lido!", code_used: "C√≥digo j√° usado!", code_ok: "C√≥digo Resgatado!", daily: "Dia"
                }
            },
            ru: {
                welcome: "–° –í–û–ó–í–†–ê–©–ï–ù–ò–ï–ú", off_earn: "–û—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥:", collect: "–ó–ê–ë–†–ê–¢–¨",
                lvl_sys: "–°–ò–°–¢–ï–ú–ê –£–†–û–í–ù–ï–ô", wd_tit: "–í–´–í–û–î (TRC20)", wd_info: "–ú–∏–Ω: ‚Ç¨1.00 | –ö–æ–º: 2%",
                avail: "–î–æ—Å—Ç—É–ø–Ω–æ:", receive: "–í—ã –ø–æ–ª—É—á–∏—Ç–µ:", fee_inc: "(–° –∫–æ–º–∏—Å—Å–∏–µ–π)", confirm: "–ü–û–î–¢–í–ï–†–î–ò–¢–¨",
                energy: "–≠–ù–ï–†–ì–ò–Ø", pps: "–ü–†–ò–ë–´–õ–¨/–°–ï–ö", market: "–†–´–ù–û–ö", wallet: "–ö–û–®–ï–õ–ï–ö",
                rank_tit: "–¢–û–ü –ò–ù–í–ï–°–¢–û–†–û–í", load_rank: "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...", rank_off: "–û—Ñ–ª–∞–π–Ω (–û—à–∏–±–∫–∞ –ë–î)", net_tit: "–°–ï–¢–¨",
                inv_desc: "–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π 5%!", copy_link: "–ö–û–ü–ò–†–û–í–ê–¢–¨",
                task_tit: "–ó–ê–î–ê–ù–ò–Ø", join_ch: "–í—Å—Ç—É–ø–∏—Ç—å –≤ –∫–∞–Ω–∞–ª", rew: "+‚Ç¨0.10 –ù–∞–≥—Ä–∞–¥–∞",
                promo_tit: "–°–ï–ö–†–ï–¢–ù–´–ô –ö–û–î", redeem: "–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨", force_play: "‚ö†Ô∏è –ò–ì–†–ê–¢–¨ –û–§–õ–ê–ô–ù", db_slow: "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...", db_err: "–û—à–∏–±–∫–∞: ",
                nav: ["–ú–ê–ô–ù–ò–ù–ì", "–ú–ê–†–ö–ï–¢", "–ò–ì–†–´", "–ö–û–ú–ê–ù–î–ê", "–¢–û–ü"],
                miners: ["–ú–∏–∫—Ä–æ –£–∑–µ–ª", "Blade –°—Ç–æ–π–∫–∞", "–¢—É—Ä–±–æ –°–µ—Ä–≤–µ—Ä", "–ö–∏–±–µ—Ä –°—Ç–∞–Ω—Ü–∏—è", "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –†–∏–≥", "–ù–µ–π—Ä–æ –•–∞–±"],
                alerts: {
                    copied: "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!", invalid_trc20: "–ù–µ–≤–µ—Ä–Ω—ã–π –∞–¥—Ä–µ—Å TRC20!", min_wd: "–ú–∏–Ω–∏–º—É–º –≤—ã–≤–æ–¥–∞ ‚Ç¨",
                    insufficient: "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –£ –≤–∞—Å —Ç–æ–ª—å–∫–æ ‚Ç¨", req_sent: "–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!",
                    inv_hash: "–ù–µ–≤–µ—Ä–Ω—ã–π —Ö–µ—à", dep_sub: "–î–µ–ø–æ–∑–∏—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!", rew_rec: "–ü–æ–ª—É—á–µ–Ω–æ!",
                    code_inv: "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!", code_used: "–ö–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω!", code_ok: "–ö–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!", daily: "–î–µ–Ω—å"
                }
            }
        };

        // ECONOMIA ATUALIZADA - MICRO TRANSACOES
        const minerStats = [ 
            {p:0.05,  g:0.00000003, img: "miner1.jpg"}, 
            {p:0.50,  g:0.00000032, img: "miner2.jpg"}, 
            {p:2.50,  g:0.00000170, img: "miner3.jpg"}, 
            {p:8.00,  g:0.00000580, img: "miner4.jpg"}, 
            {p:18.00, g:0.00001390, img: "miner5.jpg"}, 
            {p:40.00, g:0.00003300, img: "miner6.jpg"}  
        ];

        // BOOSTER STATS
        const boosterStats = [
            {name: "Multitap Lv.2", p: 1.00, type: "tap", val: 2, icon: "üí™"},
            {name: "Max Energy 1000", p: 0.50, type: "eng", val: 500, icon: "üîã"},
            {name: "Multitap Lv.3", p: 5.00, type: "tap", val: 3, icon: "üî•"},
            {name: "Max Energy 2000", p: 2.00, type: "eng", val: 1000, icon: "‚ö°"}
        ];

        // ACHIEVEMENTS DATA
        const ACHIEVEMENTS = [
            {id: 'click_100', title: 'Fast Fingers', desc: 'Click 100 times', reward: 0.05, icon: 'üëÜ', target: 100, type: 'clicks'},
            {id: 'miner_1', title: 'Investor', desc: 'Buy your first miner', reward: 0.10, icon: 'üíº', target: 1, type: 'miners'},
            {id: 'bal_10', title: 'Rich Kid', desc: 'Reach ‚Ç¨10.00 balance', reward: 0.50, icon: 'üí∞', target: 10, type: 'bal'}
        ];

        let u = { bal: 0, pps: 0, eng: 500, maxEng: 500, multitap: 1, totalClicks: 0, inv: [0,0,0,0,0,0], achievements: {}, tasks: {}, codes: {}, lastT: Date.now(), streak: 0, lastDaily: 0, name: "User", photo: "", username: "" };
        let loaded = false;
        let dailyRewVal = 0;
        let lastClickTime = 0;
        let clicksThisSecond = 0;
        let activeShopTab = 'miners';
        let lastRank = "";
        
        setInterval(() => { clicksThisSecond = 0; }, 1000); 
        
        let turboVal = 0;
        let isTurbo = false;
        let isSpinning = false;

        window.finishLoad = function() {
            if(loaded) return;
            loaded = true;
            up(); renderShop(); checkTasks(); loadRank(); checkAchievements();
            document.getElementById('loader').style.display = 'none';
        };

        function startBoot() {
            const lines = [
                "> INITIALIZING KERNEL...",
                "> CONNECTING TO EURO-NET...",
                "> BYPASSING SECURITY LAYER 1...",
                "> DECRYPTING WALLET DATA...",
                "> ACCESS GRANTED."
            ];
            let container = document.getElementById('boot-seq');
            if(container) container.innerHTML = ''; 
            let delay = 0;
            lines.forEach((line, i) => {
                setTimeout(() => {
                    let div = document.createElement('div');
                    div.className = 'boot-text';
                    div.innerText = line;
                    if(container) container.appendChild(div);
                }, delay);
                delay += 800;
            });
            setTimeout(() => {
                if(!loaded && document.getElementById('force-btn')) {
                    document.getElementById('force-btn').style.display = 'block';
                }
            }, 4500);
        }

        let tg, uid, uName, uPhoto, uUser;
        try { 
            tg = window.Telegram.WebApp; 
            tg.expand(); 
            uid = tg.initDataUnsafe.user?.id || 22250; 
            uName = tg.initDataUnsafe.user?.first_name || "Miner";
            uPhoto = tg.initDataUnsafe.user?.photo_url || "";
            uUser = tg.initDataUnsafe.user?.username ? "@"+tg.initDataUnsafe.user.username : "";
        } catch (e) { uid = 22250; uName = "Test User"; uPhoto=""; uUser=""; }

        try {
            firebase.initializeApp({
                apiKey: "AIzaSyAMqx6zI2QN9Hon_T9xTvML46pS0uEdEa0",
                authDomain: "eurodash-official.firebaseapp.com",
                databaseURL: "https://eurodash-official-default-rtdb.europe-west1.firebasedatabase.app/",
                projectId: "eurodash-official",
                storageBucket: "eurodash-official.firebasestorage.app",
                messagingSenderId: "633116941203",
                appId: "1:633116941203:web:0b3ca1ce3b9b5a63626666"
            });
        } catch(err) { console.log(err); }

        const db = firebase.database();
        let tickerMessages = ["Welcome to EuroDash", "System Online"];
        function updateTicker(msg) {
            tickerMessages.unshift(msg);
            if(tickerMessages.length > 5) tickerMessages.pop();
            let fullText = tickerMessages.join(" --- ");
            document.getElementById('news-ticker').innerText = fullText;
        }

        function showNotify(msg, type = 'success') {
            let box = document.getElementById('toast-box');
            let div = document.createElement('div');
            div.className = 'toast ' + type;
            div.innerText = msg;
            box.appendChild(div);
            if(type === 'error') tg.HapticFeedback.notificationOccurred('error');
            else tg.HapticFeedback.impactOccurred('light');
            setTimeout(() => {
                div.style.animation = 'fadeOut 0.3s forwards';
                setTimeout(() => div.remove(), 300);
            }, 3000);
        }

        function saveNow() {
            if(uid) {
                u.lastT = Date.now();
                db.ref('users/' + uid).update(u);
            }
        }

        window.onload = function() {
            startBoot();
            if(document.getElementById('disp-uid')) document.getElementById('disp-uid').innerText = uid;
            if(document.getElementById('admin-wallet')) document.getElementById('admin-wallet').innerText = CONFIG.admin_wallet;
            if(document.getElementById('qr-code')) document.getElementById('qr-code').src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${CONFIG.admin_wallet}`;
            setLang('en');
            if(uid == ADMIN_ID) { 
                let adminBtn = document.getElementById('btn-admin');
                if(adminBtn) adminBtn.style.display = 'block'; 
            }
            const onlineRef = db.ref('.info/connected');
            const myConRef = db.ref(`online/${uid}`);
            onlineRef.on('value', (snap) => {
                if (snap.val() === true) {
                    myConRef.set(true);
                    myConRef.onDisconnect().remove();
                }
            });
            db.ref('online').on('value', (snap) => {
                let count = snap.numChildren();
                if(document.getElementById('online-users')) document.getElementById('online-users').innerText = "üü¢ " + count + " Online";
            });
            db.ref('withdrawals').limitToLast(1).on('child_added', snap => {
                let val = snap.val();
                if(val && val.val) updateTicker(`üí∞ User ${val.uid.toString().substr(0,4)}... just withdrew ‚Ç¨${parseFloat(val.val).toFixed(2)}`);
            });
            db.ref('users').limitToLast(1).on('child_added', snap => {
                let val = snap.val();
                if(val && val.name) updateTicker(`üöÄ ${val.name} just joined EuroDash!`);
            });
            db.ref('broadcast').on('value', (snap) => {
                if(snap.exists()) {
                    let msg = snap.val();
                    if(msg && msg.length > 0) showNotify(msg);
                }
            });
            setTimeout(() => {
                db.ref('users/' + uid).once('value').then(s => {
                    if(s.exists()) {
                        let d = s.val();
                        u = { ...u, ...d };
                        u.inv = Array.isArray(d.inv) ? d.inv : [0,0,0,0,0,0];
                        if(!u.codes) u.codes = {};
                        if(!u.achievements) u.achievements = {};
                        if(!u.multitap) u.multitap = 1;
                        if(!u.maxEng) u.maxEng = 500;
                        if(!u.totalClicks) u.totalClicks = 0;
                        u.name = uName; u.photo = uPhoto; u.username = uUser;
                        let sec = (Date.now() - (u.lastT||Date.now())) / 1000;
                        if(sec > MAX_OFFLINE_SEC) sec = MAX_OFFLINE_SEC; 
                        if(sec > 60 && u.pps > 0) {
                            let profit = sec * u.pps;
                            u.bal += profit;
                            if(document.getElementById('off-val')) document.getElementById('off-val').innerText = profit.toFixed(4);
                            openModal('modal-offline');
                        }
                    } else { 
                        u.name = uName; u.photo = uPhoto; u.username = uUser; 
                        u.inv[0] = 1; u.pps = minerStats[0].g; 
                        saveNow(); openModal('modal-tutorial');
                    }
                    checkDaily();
                    finishLoad();
                }).catch(error => {
                    if(document.getElementById('force-btn')) {
                        document.getElementById('force-btn').innerText = "OFFLINE MODE";
                        document.getElementById('force-btn').style.display = 'block';
                    }
                });
            }, 4000); 
            if(document.getElementById('my-link')) document.getElementById('my-link').innerText = `https://t.me/EuroDashMinerBot?start=${uid}`;
            let clickBtn = document.getElementById('click-btn');
            if(clickBtn) {
                clickBtn.addEventListener('touchstart', handleTouch, {passive:false});
                clickBtn.addEventListener('click', handleClick);
            }
        };

        function buyRefill() {
            if(u.bal >= 0.05) {
                u.bal -= 0.05;
                u.eng = u.maxEng || 500;
                saveNow(); up(); closeModal('modal-refill'); showNotify("Energy Refilled! ‚ö°");
            } else showNotify("Not enough funds (‚Ç¨0.05)", "error");
        }

        function spinWheel() {
            if(isSpinning) return;
            const now = Date.now();
            const msInDay = 86400000;
            let cost = 0;
            if (now - (u.lastSpin||0) < msInDay) {
                cost = 0.20;
                if(u.bal < cost) { showNotify("Free Spin in 24h. Cost: ‚Ç¨0.20", "error"); return; }
            }
            u.bal -= cost;
            u.lastSpin = now; 
            isSpinning = true;
            saveNow();
            let wheel = document.getElementById('lucky-wheel');
            let deg = Math.floor(5000 + Math.random() * 5000); 
            wheel.style.transform = `rotate(${deg}deg)`;
            setTimeout(() => {
                isSpinning = false;
                let outcome = Math.random();
                let reward = 0;
                let msg = "";
                if(outcome < 0.5) { u.eng = u.maxEng; msg = "Refilled Energy! ‚ö°"; tg.HapticFeedback.notificationOccurred('warning'); }
                else if(outcome < 0.8) { reward = 0.10; msg = "Won ‚Ç¨0.10!"; tg.HapticFeedback.notificationOccurred('success'); }
                else if(outcome < 0.95) { reward = 0.50; msg = "Big Win! ‚Ç¨0.50"; tg.HapticFeedback.notificationOccurred('success'); } 
                else { reward = 1.00; msg = "JACKPOT! ‚Ç¨1.00 ü§ë"; tg.HapticFeedback.notificationOccurred('success'); }
                if(reward > 0) u.bal += reward;
                showNotify(msg);
                saveNow();
                wheel.style.transition = 'none';
                wheel.style.transform = `rotate(${deg % 360}deg)`;
                setTimeout(() => { wheel.style.transition = 'transform 4s cubic-bezier(0.25, 0.1, 0.25, 1)'; }, 50);
            }, 4000);
        }

        function rollDice() {
            let bet = parseFloat(document.getElementById('dice-bet').value);
            if(!bet || bet <= 0) return;
            if(u.bal < bet) { showNotify("Insufficient funds!", "error"); return; }
            u.bal -= bet;
            saveNow(); 
            let el = document.getElementById('dice-result');
            el.innerText = "ROLLING...";
            el.className = "game-res";
            setTimeout(() => {
                let win = Math.random() > 0.55; 
                if(win) {
                    let profit = bet * 2; u.bal += profit;
                    el.innerText = "WIN! +‚Ç¨" + profit.toFixed(2); el.className = "game-res win";
                    tg.HapticFeedback.notificationOccurred('success');
                } else {
                    el.innerText = "LOST -‚Ç¨" + bet.toFixed(2); el.className = "game-res lose";
                    tg.HapticFeedback.notificationOccurred('error');
                }
                up(); saveNow(); 
            }, 1000);
        }

        function flipCoin(choice) {
            let bet = parseFloat(document.getElementById('coin-bet').value);
            if(!bet || bet <= 0) return;
            if(u.bal < bet) { showNotify("Insufficient funds!", "error"); return; }
            u.bal -= bet;
            saveNow(); 
            let el = document.getElementById('coin-result');
            el.classList.add('coin-anim');
            setTimeout(() => {
                el.classList.remove('coin-anim');
                let outcome = Math.random() > 0.5 ? 'heads' : 'tails';
                let symbol = outcome === 'heads' ? 'üü°' : 'ü¶Ö';
                if(choice === outcome) {
                    let profit = bet * 2; u.bal += profit;
                    el.innerHTML = symbol + "<br><span class='win'>WIN!</span>";
                    tg.HapticFeedback.notificationOccurred('success');
                } else {
                    el.innerHTML = symbol + "<br><span class='lose'>LOSE</span>";
                    tg.HapticFeedback.notificationOccurred('error');
                }
                up(); saveNow(); 
            }, 1000);
        }

        function loadAdmin() {
            if(uid != ADMIN_ID && document.getElementById('btn-admin').style.display == 'none') return;
            document.getElementById('admin-list').innerHTML = "Loading...";
            db.ref('deposits').orderByChild('status').equalTo('pending').once('value').then(snap => {
                let html = "";
                if(snap.exists()) {
                    snap.forEach(c => {
                        let d = c.val();
                        let key = c.key;
                        let displayUser = d.username || d.uid;
                        html += `<div class="admin-row"><b>USER:</b> ${displayUser}<br><b>HASH:</b> ...${d.hash.substr(-6)}<br><div class="admin-actions"><button class="a-btn a-check" onclick="window.open('https://tronscan.org/#/transaction/${d.hash}')">CHECK</button><button class="a-btn a-approve" onclick="adminAction('${key}', '${d.uid}', 'approve')">OK</button><button class="a-btn a-reject" onclick="adminAction('${key}', '${d.uid}', 'reject')">X</button></div></div>`;
                    });
                } else { html = "<small>No pending deposits.</small>"; }
                document.getElementById('admin-list').innerHTML = html;
            });
        }

        function adminAction(key, userUid, action) {
            if(action === 'approve') {
                let amount = prompt("Amount to credit (‚Ç¨):");
                if(!amount) return;
                amount = parseFloat(amount);
                db.ref('users/' + userUid + '/bal').transaction(c => (c || 0) + amount);
                db.ref('deposits/' + key).update({ status: 'approved', amount: amount });
                alert("Credited ‚Ç¨" + amount);
                loadAdmin();
            } else {
                if(confirm("Reject?")) { db.ref('deposits/' + key).update({ status: 'rejected' }); loadAdmin(); }
            }
        }

        function checkDaily() {
            const now = Date.now();
            const msInDay = 86400000;
            if(now - (u.lastDaily || 0) > msInDay) {
                if(now - (u.lastDaily || 0) > msInDay * 2) { u.streak = 0; }
                let dayIdx = u.streak % 7;
                dailyRewVal = DAILY_REWARDS[dayIdx];
                document.getElementById('daily-amt').innerText = dailyRewVal.toFixed(2);
                document.querySelectorAll('.day-box').forEach((el, i) => { el.classList.toggle('active', i === dayIdx); });
                openModal('modal-daily');
            }
        }

        function claimDaily() { u.bal += dailyRewVal; u.lastDaily = Date.now(); u.streak++; up(); saveNow(); closeModal('modal-daily'); showNotify(txt[CUR_LANG].alerts.rew_rec); }

        function setLang(l) {
            CUR_LANG = l;
            document.querySelectorAll('.l-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-'+l).classList.add('active');
            const t = txt[l];
            if(document.getElementById('t-welcome')) document.getElementById('t-welcome').innerText = t.welcome;
            if(document.getElementById('t-off-earn')) document.getElementById('t-off-earn').innerText = t.off_earn;
            if(document.getElementById('t-collect')) document.getElementById('t-collect').innerText = t.collect;
            if(document.getElementById('t-lvl-sys')) document.getElementById('t-lvl-sys').innerText = t.lvl_sys;
            if(document.getElementById('t-wd-tit')) document.getElementById('t-wd-tit').innerText = t.wd_tit;
            if(document.getElementById('t-wd-info')) document.getElementById('t-wd-info').innerText = t.wd_info;
            if(document.getElementById('t-avail')) document.getElementById('t-avail').innerText = t.avail;
            if(document.getElementById('t-receive')) document.getElementById('t-receive').innerText = t.receive;
            if(document.getElementById('t-fee-inc')) document.getElementById('t-fee-inc').innerText = t.fee_inc;
            if(document.getElementById('t-confirm')) document.getElementById('t-confirm').innerText = t.confirm;
            if(document.getElementById('t-energy')) document.getElementById('t-energy').innerText = t.energy;
            if(document.getElementById('t-pps')) document.getElementById('t-pps').innerText = t.pps;
            if(document.getElementById('t-market')) document.getElementById('t-market').innerText = t.market;
            if(document.getElementById('t-wallet')) document.getElementById('t-wallet').innerText = t.wallet;
            if(document.getElementById('t-rank-tit')) document.getElementById('t-rank-tit').innerText = t.rank_tit;
            if(document.getElementById('t-load-rank')) document.getElementById('t-load-rank').innerText = t.load_rank;
            if(document.getElementById('t-net-tit')) document.getElementById('t-net-tit').innerText = t.net_tit;
            if(document.getElementById('t-inv-desc')) document.getElementById('t-inv-desc').innerText = t.inv_desc;
            if(document.getElementById('t-copy-link')) document.getElementById('t-copy-link').innerText = t.copy_link;
            if(document.getElementById('t-task-tit')) document.getElementById('t-task-tit').innerText = t.task_tit;
            if(document.getElementById('t-join-ch')) document.getElementById('t-join-ch').innerText = t.join_ch;
            if(document.getElementById('t-rew')) document.getElementById('t-rew').innerText = t.rew;
            if(document.getElementById('t-promo-tit')) document.getElementById('t-promo-tit').innerText = t.promo_tit;
            if(document.getElementById('t-redeem')) document.getElementById('t-redeem').innerText = t.redeem;
            if(document.getElementById('force-btn')) document.getElementById('force-btn').innerText = t.force_play;
            if(document.getElementById('load-status')) document.getElementById('load-status').innerText = t.db_slow;
            if(document.getElementById('n-mine')) document.getElementById('n-mine').innerText = t.nav[0];
            if(document.getElementById('n-shop')) document.getElementById('n-shop').innerText = t.nav[1];
            if(document.getElementById('n-games')) document.getElementById('n-games').innerText = t.nav[2]; 
            if(document.getElementById('n-team')) document.getElementById('n-team').innerText = t.nav[3];
            if(document.getElementById('n-rank')) document.getElementById('n-rank').innerText = t.nav[4];
            renderShop(); loadRank();
        }

        function copyWallet() {
            navigator.clipboard.writeText(CONFIG.admin_wallet).then(() => {
                showNotify(txt[CUR_LANG].alerts.copied);
                let walletDiv = document.getElementById('admin-wallet').parentElement;
                walletDiv.style.borderColor = "#0f9";
                walletDiv.style.backgroundColor = "#2a2a2a";
                setTimeout(() => { walletDiv.style.borderColor = "#0f9"; walletDiv.style.backgroundColor = "#222"; }, 200);
            });
        }

        function sendProof() {
            let adminUsername = "RussianMafia76"; 
            let msg = `Hello Admin! I deposited USDT to EuroDash.\n\nMy ID: ${uid}\n(Please find the screenshot attached)`;
            let url = `https://t.me/${adminUsername}?text=${encodeURIComponent(msg)}`;
            tg.openTelegramLink(url);
            closeModal('modal-deposit');
        }

        function loadRank() {
            db.ref('users').orderByChild('bal').limitToLast(10).once('value').then(snap => {
                let html = '';
                let list = [];
                snap.forEach(c => list.push(c.val()));
                list.reverse(); 
                list.forEach((p, i) => {
                    let style = i===0 ? 'color:#ffd700' : 'color:#fff';
                    let img = p.photo ? `<img src="${p.photo}" class="rank-img">` : `<div class="rank-img" style="display:flex;align-items:center;justify-content:center;color:#0f9;">?</div>`;
                    let money = p.bal ? p.bal.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) : "0.00";
                    html += `<div class="rank-row"><span style="width:30px; ${style}">#${i+1}</span>${img}<span style="flex-grow:1; text-align:left;">${p.name || "User"}</span><span style="color:#0f9; font-weight:bold;">‚Ç¨${money}</span></div>`;
                });
                if(document.getElementById('rank-list')) document.getElementById('rank-list').innerHTML = html;
            }).catch(e => { });
        }

        function checkTasks() { if(u.tasks['group']) { let btn = document.getElementById('task-group'); if(btn) { btn.innerText = "DONE"; btn.style.opacity = 0.5; } } }
        function doTask(id, reward) {
            if(u.tasks[id]) return;
            tg.openLink(CONFIG.telegram_link);
            setTimeout(() => {
                tg.showConfirm("Did you join the channel?", (ok) => {
                    if(ok) { u.tasks[id] = true; u.bal += reward; up(); checkTasks(); saveNow(); showNotify(`${txt[CUR_LANG].alerts.rew_rec} +‚Ç¨${reward}`); }
                });
            }, 8000);
        }

        function checkAchievements() {
            let list = document.getElementById('ach-list');
            if(!list) return;
            let html = "";
            let invCount = u.inv.reduce((a,b)=>a+b, 0);
            
            ACHIEVEMENTS.forEach(a => {
                let progress = 0;
                if(a.type === 'clicks') progress = u.totalClicks;
                if(a.type === 'miners') progress = invCount;
                if(a.type === 'bal') progress = u.bal;
                
                let unlocked = progress >= a.target;
                let cls = unlocked ? 'ach-row unlocked' : 'ach-row';
                let status = unlocked ? (u.achievements[a.id] ? "CLAIMED" : "UNLOCKED!") : `${Math.min(progress, a.target).toFixed(0)}/${a.target}`;
                let action = (unlocked && !u.achievements[a.id]) ? `onclick="claimAch('${a.id}', ${a.reward})"` : "";
                
                html += `<div class="${cls}" ${action}>
                    <div class="ach-icon">${a.icon}</div>
                    <div class="ach-info"><b>${a.title}</b><br><small>${a.desc}</small></div>
                    <div style="font-size:10px; font-weight:bold;">${status}</div>
                </div>`;
            });
            list.innerHTML = html;
        }

        function claimAch(id, reward) {
            if(u.achievements[id]) return;
            u.achievements[id] = true;
            u.bal += reward;
            showNotify(`Achievement Unlocked! +‚Ç¨${reward}`);
            tg.HapticFeedback.notificationOccurred('success');
            saveNow(); checkAchievements();
        }

        function showLevelUp(rank) {
            let overlay = document.getElementById('levelup-overlay');
            document.getElementById('new-rank-name').innerText = rank;
            overlay.style.display = 'flex';
            tg.HapticFeedback.notificationOccurred('success');
            // Confetti
            for(let i=0; i<30; i++) {
                let c = document.createElement('div');
                c.className = 'confetti';
                c.style.left = Math.random()*100 + '%';
                c.style.background = ['#f00', '#0f9', '#00f', '#ff0'][Math.floor(Math.random()*4)];
                c.style.animationDuration = (Math.random()*2+2)+'s';
                overlay.appendChild(c);
                setTimeout(()=>c.remove(), 4000);
            }
        }

        function up() {
            if(document.getElementById('bal-val')) document.getElementById('bal-val').innerText = u.bal.toFixed(5);
            if(document.getElementById('bal-shop')) document.getElementById('bal-shop').innerText = u.bal.toFixed(2);
            if(document.getElementById('eg')) document.getElementById('eg').innerText = Math.floor(u.eng);
            if(document.getElementById('pps-disp')) document.getElementById('pps-disp').innerText = (u.pps*100).toFixed(6);
            
            let maxEng = u.maxEng || 500;
            let pct = (u.eng / maxEng) * 100;
            if(document.getElementById('eng-bar')) document.getElementById('eng-bar').style.width = pct + "%";
            
            if(u.bal >= minerStats[0].p) document.getElementById('badge-shop').style.display = 'block';
            else document.getElementById('badge-shop').style.display = 'none';
            if(u.bal >= 0.10) document.getElementById('badge-games').style.display = 'block';
            else document.getElementById('badge-games').style.display = 'none';

            if(document.getElementById('tab-shop').style.display === 'block') renderShop();

            // Level Up Check
            let l = "NOOB";
            if(u.bal < 10) { matrixColor = '#0f9'; }
            else if(u.bal < 50) { l = "HACKER"; matrixColor = '#00ffff'; }
            else if(u.bal < 200) { l = "CYBER LORD"; matrixColor = '#ff00ff'; }
            else { l = "TITAN"; matrixColor = '#ffd700'; }
            
            if(document.getElementById('l-fill')) {
                let w = 0;
                if(l==="NOOB") w = (u.bal/10)*100;
                else if(l==="HACKER") w = (u.bal/50)*100;
                else if(l==="CYBER LORD") w = (u.bal/200)*100;
                else w = 100;
                document.getElementById('l-fill').style.width = w+"%";
                document.getElementById('l-name').innerText = l;
            }

            if(lastRank !== "" && lastRank !== l) showLevelUp(l);
            lastRank = l;

            // Update Image
            let bestMinerIdx = -1;
            for(let i = minerStats.length - 1; i >= 0; i--) {
                if(u.inv[i] > 0) { bestMinerIdx = i; break; }
            }
            if(bestMinerIdx >= 0) {
                let currentImg = document.getElementById('click-btn').getAttribute('src');
                let newImg = minerStats[bestMinerIdx].img;
                if(currentImg !== newImg) document.getElementById('click-btn').src = newImg;
            }
        }

        function toggleShop(type) {
            activeShopTab = type;
            document.querySelectorAll('.shop-tab').forEach(el => el.classList.remove('active'));
            document.getElementById('st-'+type).classList.add('active');
            renderShop();
        }

        function renderShop() {
            if(!document.getElementById('shop-list')) return;
            let html = "";
            if(activeShopTab === 'miners') {
                let names = txt[CUR_LANG].miners;
                html = minerStats.map((m,i) => {
                    let itemName = names[i] || "Secret Miner"; 
                    let canAfford = u.bal >= m.p;
                    let btnColor = canAfford ? '#0f9' : '#555';
                    let btnCursor = canAfford ? 'pointer' : 'not-allowed';
                    let btnOpacity = canAfford ? '1' : '0.6';
                    let tag = '';
                    if(i === 2) tag = `<div class="badge-tag tag-best">BEST VALUE</div>`;
                    if(i === 3) tag = `<div class="badge-tag tag-hot">POPULAR</div>`;
                    return `
                    <div class="card">
                        ${tag}
                        <div style="display:flex; align-items:center; gap:10px;">
                            <img src="${m.img}" style="width:50px; height:50px; border-radius:5px;" onerror="this.outerHTML='<div class=\\'fallback-icon\\'>${MINER_EMOJIS[i]||'üíª'}</div>'">
                            <div><b>${itemName}</b><br><small style="color:#888">Lvl: ${u.inv[i]||0} | +‚Ç¨${(m.g*3600).toFixed(4)}/h</small></div>
                        </div>
                        <button class="buy-btn" onclick="buyMiner(${i}, event)" 
                            style="background:${btnColor}; cursor:${btnCursor}; opacity:${btnOpacity};">
                            ‚Ç¨${m.p.toFixed(2)}
                        </button>
                    </div>`;
                }).join('');
            } else {
                html = boosterStats.map((b, i) => {
                    let canAfford = u.bal >= b.p;
                    let btnColor = canAfford ? '#ffd700' : '#555';
                    let btnCursor = canAfford ? 'pointer' : 'not-allowed';
                    let btnOpacity = canAfford ? '1' : '0.6';
                    let purchased = false;
                    if(b.type === 'tap' && u.multitap >= b.val) purchased = true;
                    if(b.type === 'eng' && (u.maxEng || 500) >= b.val) purchased = true;
                    let btnText = purchased ? "OWNED" : `‚Ç¨${b.p.toFixed(2)}`;
                    let action = purchased ? "" : `onclick="buyBooster(${i})"`;
                    if(purchased) { btnColor = "#333"; btnOpacity = "0.5"; }
                    return `
                    <div class="card" style="border-left: 3px solid #ffd700;">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="fallback-icon" style="color:#ffd700; border-color:#ffd700;">${b.icon}</div>
                            <div><b>${b.name}</b><br><small style="color:#888">Permanent Upgrade</small></div>
                        </div>
                        <button class="buy-btn" ${action}
                            style="background:${btnColor}; cursor:${btnCursor}; opacity:${btnOpacity}; color:#000;">
                            ${btnText}
                        </button>
                    </div>`;
                }).join('');
            }
            html += '<div class="spacer">--- END OF MARKET ---</div>';
            document.getElementById('shop-list').innerHTML = html;
        }

        function buyMiner(i, e) {
            if(u.bal >= minerStats[i].p) {
                u.bal -= minerStats[i].p; u.pps += minerStats[i].g; u.inv[i] = (u.inv[i]||0)+1;
                spawnFloat(e.clientX, e.clientY, minerStats[i].g*3600, false, true); 
                renderShop(); up(); saveNow(); 
                showNotify("Miner Purchased!");
                tg.HapticFeedback.notificationOccurred('success');
            } else showNotify("Not enough funds!", "error");
        }

        function buyBooster(i) {
            let b = boosterStats[i];
            if(u.bal >= b.p) {
                u.bal -= b.p;
                if(b.type === 'tap') u.multitap = b.val;
                if(b.type === 'eng') u.maxEng = b.val;
                renderShop(); up(); saveNow();
                showNotify("Upgrade Successful! üöÄ");
                tg.HapticFeedback.notificationOccurred('success');
            } else showNotify("Not enough funds!", "error");
        }

        function openSupport() { tg.openTelegramLink("https://t.me/RussianMafia76"); tg.HapticFeedback.impactOccurred('medium'); }
        function openChannel() { tg.openTelegramLink("https://t.me/EuroDashOfficial"); tg.HapticFeedback.impactOccurred('medium'); }
        
        function openModal(id) { 
            document.getElementById(id).style.display = 'flex'; 
            if(id === 'modal-withdraw') {
                up();
                db.ref('withdrawals').orderByChild('uid').equalTo(uid).limitToLast(3).once('value').then(snap => {
                    let html = "<b>Recent History:</b><br>";
                    if(snap.exists()) {
                        snap.forEach(s => {
                            let d = s.val();
                            let color = d.status === 'pending' ? 'orange' : (d.status === 'approved' ? '#0f9' : 'red');
                            html += `<div style="border-bottom:1px solid #333; padding:2px;">‚Ç¨${d.val} <span style="float:right; color:${color}">${d.status.toUpperCase()}</span></div>`;
                        });
                    } else html += "No requests yet.";
                    document.getElementById('wd-history').innerHTML = html;
                });
            }
            if(id === 'modal-deposit') {
                if(document.getElementById('proof-uid')) document.getElementById('proof-uid').innerText = uid;
            }
            if(id === 'modal-achievements') checkAchievements();
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        
        function sw(t) {
            if(t === 'admin') loadAdmin();
            document.querySelectorAll('.tab').forEach(e=>e.style.display='none');
            document.getElementById('tab-'+t).style.display='block';
            document.querySelectorAll('.n-btn').forEach(b=>b.classList.remove('active'));
            if(t !== 'admin') document.getElementById('nb-'+t).classList.add('active');
            if(t === 'shop') renderShop();
            tg.HapticFeedback.impactOccurred('light');
        }
        
        function copyLink() { navigator.clipboard.writeText(document.getElementById('my-link').innerText); showNotify(txt[CUR_LANG].alerts.copied); }

        function handleTouch(e) { e.preventDefault(); if(u.eng>0) for(let i=0; i<e.changedTouches.length; i++) tap(e.changedTouches[i].clientX, e.changedTouches[i].clientY); }
        function handleClick(e) { if(u.eng>0) tap(e.clientX, e.clientY); }
        
        function tap(x, y) {
            if(clicksThisSecond > 15) return; 
            clicksThisSecond++;
            const now = Date.now();
            if (now - lastClickTime < 60) return;
            lastClickTime = now;
            if(u.eng < 1) return;
            u.eng--;
            if(typeof u.totalClicks === 'undefined') u.totalClicks = 0;
            u.totalClicks++; 
            playBeep();
            
            let btn = document.getElementById('click-btn');
            btn.classList.remove('click-anim');
            void btn.offsetWidth;
            btn.classList.add('click-anim');

            let gain = 0.00005 * (u.multitap || 1);
            
            if(isTurbo) {
                gain *= 2; 
                spawnFloat(x, y-50, "üî• x2", false, true); 
            } else {
                turboVal += 2; 
                if(turboVal >= 100) activateTurbo();
                document.getElementById('turbo-bar').style.width = turboVal + "%";
            }

            let critChance = 0.02; 
            if(u.bal >= 50) critChance = 0.05;
            let isCrit = Math.random() < critChance;
            if(isCrit) { 
                gain *= 10; 
                tg.HapticFeedback.notificationOccurred('success');
                document.body.classList.add('shake');
                setTimeout(() => document.body.classList.remove('shake'), 500);
            } else { 
                tg.HapticFeedback.impactOccurred('light'); 
            }

            createParticles(x, y);
            let isLucky = Math.random() < 0.002; 
            if(isLucky) {
                let bonus = 0.05;
                u.bal += bonus;
                spawnFloat(x, y, bonus, false, true); 
                tg.HapticFeedback.notificationOccurred('warning');
            }
            u.bal += gain;
            up(); spawnFloat(x, y, gain, isCrit, false);
        }

        function activateTurbo() {
            isTurbo = true;
            document.getElementById('turbo-box').classList.add('active-turbo');
            document.getElementById('turbo-msg').style.display = 'block';
            tg.HapticFeedback.notificationOccurred('warning'); 
            setTimeout(() => {
                isTurbo = false;
                turboVal = 0;
                document.getElementById('turbo-box').classList.remove('active-turbo');
                document.getElementById('turbo-bar').style.width = "0%";
                document.getElementById('turbo-msg').style.display = 'none';
            }, 10000);
        }

        setInterval(() => {
            if(!isTurbo && turboVal > 0) {
                turboVal -= 1; 
                document.getElementById('turbo-bar').style.width = turboVal + "%";
            }
        }, 200);

        function createParticles(x, y) {
            for(let i=0; i<5; i++) {
                let p = document.createElement('div');
                p.className = 'particle';
                let tx = (Math.random() - 0.5) * 100 + 'px';
                let ty = (Math.random() - 0.5) * 100 + 'px';
                p.style.setProperty('--tx', tx);
                p.style.setProperty('--ty', ty);
                p.style.left = x + 'px';
                p.style.top = y + 'px';
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 600);
            }
        }

        function spawnFloat(x, y, val, crit, lucky) {
            let el = document.createElement('div');
            let tx = (Math.random() - 0.5) * 100;
            el.style.setProperty('--tx', tx + 'px');
            if(lucky) {
                el.className = 'float-text lucky'; el.innerText = `LUCKY! +${typeof val === 'number' ? val.toFixed(2) : val}`;
            } else {
                let txt = typeof val === 'number' ? val.toFixed(5) : val;
                el.className = crit ? 'float-text crit' : 'float-text'; 
                el.innerText = crit ? `CRITICAL +${txt}` : `+${txt}`;
            }
            el.style.left = x+'px'; el.style.top = y+'px';
            document.body.appendChild(el);
            setTimeout(()=>el.remove(), 800);
        }

        function spawnGoldenEuro() {
            if(document.querySelector('.golden-euro')) return; 
            let coin = document.createElement('div');
            coin.className = 'golden-euro';
            coin.innerText = 'üü°';
            coin.style.top = Math.random() * (window.innerHeight - 100) + 'px';
            coin.onclick = function() {
                u.bal += 0.10; 
                tg.HapticFeedback.notificationOccurred('success');
                spawnFloat(parseInt(coin.style.left)||100, parseInt(coin.style.top)||100, 0.10, false, true);
                coin.remove();
                saveNow();
                showNotify("Golden Euro Found! +‚Ç¨0.10");
            };
            document.body.appendChild(coin);
            setTimeout(() => { if(coin.parentNode) coin.remove(); }, 8000);
        }

        setInterval(() => {
            if(loaded && Math.random() < 0.1) spawnGoldenEuro();
        }, 20000);

        function setMax() { document.getElementById('wd-amount').value = u.bal.toFixed(2); calcFee(); }
        function calcFee() {
            let val = parseFloat(document.getElementById('wd-amount').value) || 0;
            let final = val - (val * CONFIG.fee);
            if(final < 0) final = 0;
            document.getElementById('wd-final').innerText = final.toFixed(2);
        }

        function submitWithdraw() {
            let addr = document.getElementById('wd-addr').value;
            let val = parseFloat(document.getElementById('wd-amount').value);
            let t = txt[CUR_LANG].alerts;
            if(!addr.startsWith("T")) { showNotify(t.invalid_trc20, "error"); return; }
            if(val < CONFIG.min_withdraw) { showNotify(t.min_wd + CONFIG.min_withdraw, "error"); return; }
            if(u.bal < val) { showNotify(`${t.insufficient}${u.bal.toFixed(2)}`, "error"); return; }
            u.bal -= val;
            saveNow(); 
            db.ref('withdrawals/' + Date.now()).set({ uid: uid, addr: addr, val: val, status: "pending" });
            closeModal('modal-withdraw');
            showNotify(t.req_sent);
        }

        function redeemCode() {
            let codeInput = document.getElementById('promo-in').value.toUpperCase().trim();
            if(codeInput === "GODMODE") {
                document.getElementById('btn-admin').style.display = 'block';
                showNotify("ADMIN MODE UNLOCKED");
                return;
            }
            let t = txt[CUR_LANG].alerts;
            if(!PROMO_CODES[codeInput]) { showNotify(t.code_inv, "error"); return; }
            if(u.codes[codeInput]) { showNotify(t.code_used, "error"); return; }
            let reward = PROMO_CODES[codeInput];
            u.bal += reward;
            u.codes[codeInput] = true;
            up(); saveNow(); 
            showNotify(t.code_ok + " +‚Ç¨" + reward.toFixed(2));
            document.getElementById('promo-in').value = "";
        }

        setInterval(() => { 
            if(loaded && uid && !document.getElementById('rank-list').innerText.includes('Offline')) { 
                saveNow(); 
            } 
        }, 10000); 

        setInterval(() => { 
            if(loaded) { 
                u.bal += u.pps; 
                let max = u.maxEng || 500;
                if(u.eng < max) u.eng += 0.5; 
                up(); 
            } 
        }, 1000);
    </script>
</body>
</html>
